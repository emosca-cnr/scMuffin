[{"path":"/articles/scMuffin.html","id":"installation","dir":"Articles","previous_headings":"","what":"Installation","title":"scMuffin package vignettes","text":"scMuffin requires R >= 4.0.0, due dependencies, like Seurat (Hao et al. 2021). R can installed CRAN URL https://cran.r-project.org/index.html. succesfully install scMuffin need packages Bioconductor (https://bioconductor.org) github (https://github.com/). packages can installed using following commands: dependencies, missing, automatically installed using following command: load package:","code":"if (!require(\"BiocManager\", quietly = TRUE)){   install.packages(\"BiocManager\") } BiocManager::install(c(\"BiocStyle\", \"ComplexHeatmap\", \"DESeq2\", \"org.Hs.eg.db\"))  if (!require(\"devtools\", quietly = TRUE)){   install.packages(\"devtools\") } devtools::install_github(\"theislab/destiny\") devtools::install_github(\"emosca-cnr/scMuffin\", build_vignettes = TRUE) library(scMuffin)"},{"path":"/articles/scMuffin.html","id":"input","dir":"Articles","previous_headings":"","what":"Input","title":"scMuffin package vignettes","text":"scMuffin intended used downstream general purpose tasks like quality control, normalization, cell clustering dataset integration, dedicated tools, Seurat (Hao et al. 2021). scMuffin requires three inputs: genes--cells raw counts matrix; genes--cells normalized expression matrix; partition cells (cell clusters). rownames colnames two matrices must , respectively, gene identifiers cell identifiers. Currently, recommend use official gene symbols. analysis, like CNV inference, works gene symbols. Typically, two genes--cells matrices already filtered exclude low quality cells genes negatively affect analyses. However, characterization cells can achieved scMuffin offers insights can used () filter dataset /decide cells apply particular analyses (e.g. biomarker identification). general, according research questions experimental design strong mild filters applied using scMuffin.","code":""},{"path":"/articles/scMuffin.html","id":"obtaining-the-data-used-in-this-vignette","dir":"Articles","previous_headings":"","what":"Obtaining the data used in this vignette","title":"scMuffin package vignettes","text":"’s example obtain publicly available single cell dataset Gene Expression Omnibus (GEO). particular, consider sample study High-Grade Glioma (J. Yuan et al. 2018) (GSE103224): download filtered genes--cells mtrices URLs: sample PJ016: https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM2758471; read text files R use Seurat package (Hao et al. 2021) perform series typical tasks (e.g. normalization, clustering); ’s concise example using sample PJ016: genes--cells count matrix available NCBI GEO provided Ensembl identifiers gene symbols, unique. , read table, used function keep_strongest_representative, defines genes--cells matrix symbols row names. case multiple Ensembl ids mapped symbol, row highest average count kept representative gene. real scenario, functions listed run using appropriate parameters take account specificities dataset consideration objectives analysis user perform. just wanted provide means obtain dataset follow vignette. Please read Seurat documentation details functions listed .","code":"gbc_counts <- read.table(\"GSM2758471_PJ016.filtered.matrix.txt\") sym <- gbc_counts[, \"V2\"] gbc_counts[, \"V2\"] <- NULL gbc_counts <- keep_strongest_representative(gbc_counts, sym) seu_obj_1 <- CreateSeuratObject(count=gbc_counts, project=\"PJ016\") seu_obj_1 <- NormalizeData(seu_obj_1) seu_obj_1 <- FindVariableFeatures(seu_obj_1) seu_obj_1 <- ScaleData(seu_obj_1) seu_obj_1 <- RunPCA(seu_obj_1) seu_obj_1 <- FindNeighbors(seu_obj_1) seu_obj_1 <- FindClusters(seu_obj_1) seu_obj_1 <- RunUMAP(seu_obj_1)"},{"path":"/articles/scMuffin.html","id":"the-scmuffinlist-data-structure","dir":"Articles","previous_headings":"","what":"The scMuffinList data structure","title":"scMuffin package vignettes","text":"data results scMuffin stored scMuffinList, every function takes input structure returns modified version . scMuffinList can created follows: Many analyses require cell clusters. partition can added follows: seu_obj_1$seurat_clusters named vector contains cells clusters whose names cell labels. element partitions scMuffinList contain cell clusters:","code":"scMuffinList_demo <- create_scMuffinList(counts=GetAssayData(seu_obj_1, assay=\"RNA\", slot=\"counts\"), normalized=GetAssayData(seu_obj_1, assay=\"RNA\", slot=\"data\")) scMuffinList_demo <- add_partitions(scMuffinList_demo, clusters = seu_obj_1$seurat_clusters, partition_id = \"global_expr\") head(scMuffinList_demo$partitions[, 1, drop=F]) ##    global_expr ## V3           0 ## V4           0 ## V5           7 ## V6           0 ## V7           7 ## V8           7"},{"path":"/articles/scMuffin.html","id":"gene-set-scoring","dir":"Articles","previous_headings":"","what":"Gene set scoring","title":"scMuffin package vignettes","text":"scMuffin provides functions set one collections gene sets perform cell-level estimation gene set expression relation empirical null model. can applied gene set can therefore used estimate various cell’s phenotypes, like pathway activities markers expression.","code":""},{"path":"/articles/scMuffin.html","id":"assembling-input-gene-sets","dir":"Articles","previous_headings":"Gene set scoring","what":"Assembling input gene sets","title":"scMuffin package vignettes","text":"function prepare_gsls retrieves gene sets CellMarker [Zhang2019], PanglaoDB (Franzén, Gan, Björkegren 2019), CancerSEA (H. Yuan et al. 2019) MSigDB (Subramanian et al. 2005), accepts custom gene set well. full list gene sets available whitin CellMarker, PanglaoDB CancerSEA collections can listed using: case MSigDB can use dedicated functions: gene sets interest can selected acting corresponding arguments CM_tissues, PNDB_tissues, msigdb_hs_cat_subcat. case CellMarker PanglaoDB can specify list desired tissues. full set can listed means show_tissues. show just first part output: example: Note case MSigDB set data.frame specify species, category sub_category gene set collections.","code":"data(\"gsls_EntrezID\") data(\"gsls_Symbol\") msigdbr::msigdbr_collections() msigdbr::msigdbr_species() lapply(show_tissues(), head) ## $PNDB ## [1] \"Adrenal_glands\"    \"Blood\"             \"Bone\"              ## [4] \"Brain\"             \"Connective_tissue\" \"Embryo\"            ##  ## $CM_normal ## [1] \"Abdominal_adipose_tissue\" \"Adipose_tissue\"           ## [3] \"Adrenal_gland\"            \"Adventitia\"               ## [5] \"Airway_epithelium\"        \"Amniotic_fluid\"           ##  ## $CM_cancer ## [1] \"Adipose_tissue\" \"Ascites\"        \"Bladder\"        \"Blood\"          ## [5] \"Blood_vessel\"   \"Bone\" gsc <- prepare_gsls(gs_sources = c(\"CancerSEA\", \"PNDB\"), PNDB_tissues = c(\"Brain\"), scMuffinList = scMuffinList_demo, genes_min = 3)"},{"path":"/articles/scMuffin.html","id":"calculate-gene-set-scores-at-cell-and-cluster-level","dir":"Articles","previous_headings":"Gene set scoring","what":"Calculate Gene set scores at cell and cluster level","title":"scMuffin package vignettes","text":"following example, estimate scores CancerSEA gene sets: results analysis stored elements scMuffinList. gene set scoring engine stores results scMuffinList$gene_set_scoring, summary cells--features data.frame cell scores, full contains series additional details every gene set: values cell-level scores can used color UMAP visualizations, automatically generated every gene set using: , example UMAP visualization cells colored CancerSEA “Hypoxia” gene set score. caption function calculate_gs_scores_in_clusters defines median values gene set scores every cluster given partition id: mean values useful obtain concise visualization gene set expression throughout dataset, using function plot_heatmap_features_by_clusters: caption","code":"scMuffinList_demo <- calculate_gs_scores(scMuffinList = scMuffinList_demo, gs_list = gsc$CancerSEA) head(scMuffinList_demo$gene_set_scoring$summary) ##    Angiogenesis   Apoptosis  Cell_Cycle Differentiation DNA_damage ## V3 -0.089113218 -0.02736876  0.15982556       0.2216575 0.14051428 ## V4 -0.003587037  0.05131560  0.30245301       0.2518166 0.29326775 ## V5  0.122828520 -0.02124108 -0.01387160       0.1500232 0.16742211 ## V6 -0.072394618 -0.01090225  0.38740856       0.2247531 0.19227076 ## V7  0.114843858  0.18815302 -0.11715432       0.1688834 0.03979306 ## V8  0.180094845  0.24514734 -0.07518025       0.1015920 0.11925093 head(scMuffinList_demo$gene_set_scoring$full$Angiogenesis) ##         case case.N case.AV nmark_min avg_control control.AV null_ok ## V3 0.6209460     40      21      TRUE   0.7100592        100    TRUE ## V4 0.7282336     40      20      TRUE   0.7318207        100    TRUE ## V5 0.8418314     40      23      TRUE   0.7190029        100    TRUE ## V6 0.6632416     40      16      TRUE   0.7356362        100    TRUE ## V7 0.8363020     40      23      TRUE   0.7214581        100    TRUE ## V8 0.8964932     40      19      TRUE   0.7163984        100    TRUE ##    avg_delta_score  delta_score ## V3    -0.089113218 -0.089113218 ## V4    -0.003587037 -0.003587037 ## V5     0.122828520  0.122828520 ## V6    -0.072394618 -0.072394618 ## V7     0.114843858  0.114843858 ## V8     0.180094845  0.180094845 plot_umap_colored_features(scMuffinList_demo, Seu_obj = seu_obj_1, feature_name = \"gene_set_scoring\") scMuffinList_demo <- calculate_gs_scores_in_clusters(scMuffinList_demo, partition_id = \"global_expr\") scMuffinList_demo$cluster_data$global_expr$gene_set_scoring$summary ##   Angiogenesis    Apoptosis   Cell_Cycle Differentiation DNA_damage ## 0  0.047859938 -0.088965155  0.110267077      0.16918450 0.16103980 ## 1  0.056847826  0.036663900  0.006437504      0.16233049 0.18251283 ## 2  0.032503390 -0.034567178 -0.065434867      0.08517490 0.14345603 ## 3  0.056820484 -0.007732416 -0.043253422      0.09640405 0.07634114 ## 4  0.035065898 -0.020565102 -0.069010461      0.09766083 0.13605394 ## 5  0.057012002 -0.007916085 -0.027483616      0.12878842 0.15750102 ## 6  0.009464465 -0.048782422  0.011650033      0.14793156 0.23773401 ## 7  0.180890552 -0.004328227 -0.026837614      0.18052135 0.14210041 ## 8  0.144201389 -0.018635396  0.021841089      0.16421038 0.21497220 ## 9  0.045549704 -0.068738127  0.295309989      0.25482631 0.17238070 ##     DNA_repair       EMT      Hypoxia Inflammation  Invasion Metastasis ## 0  0.098945306 0.1429307 -0.002983632  0.008729023 0.4472744  0.1144382 ## 1  0.009465724 0.2523039  0.333431166  0.152182984 0.2503599  0.3066740 ## 2 -0.025654591 0.1912701  0.210172770  0.038350228 0.1130673  0.2673377 ## 3 -0.011475854 0.2303885  0.167091886  0.005294070 0.1752660  0.2788620 ## 4  0.030970644 0.2275091  0.304570531  0.110102310 0.1778773  0.2702203 ## 5 -0.009794570 0.2157880  0.271551139  0.066140185 0.2598153  0.2959017 ## 6  0.055899011 0.1773771 -0.037244689  0.032686215 0.2602460  0.0970928 ## 7 -0.027613833 0.3274798  0.295935075  0.110663000 0.2846644  0.3815454 ## 8  0.016203928 0.1376003 -0.046727520 -0.001804147 0.2446869  0.1113544 ## 9  0.107220520 0.1154087  0.023735537  0.041855789 0.5635380  0.1552216 ##   Proliferation   Quiescence  Stemness ## 0    0.17611146 -0.009397549 0.3951332 ## 1    0.01102549  0.068921466 0.2960947 ## 2   -0.05060590 -0.018336789 0.2438539 ## 3    0.01032691 -0.037541588 0.2649289 ## 4    0.12775340  0.153623982 0.3388603 ## 5    0.03528640 -0.031068515 0.2487021 ## 6    0.03657727 -0.077159027 0.3848135 ## 7   -0.03310542  0.051625491 0.2351137 ## 8    0.06128233  0.041054982 0.4134585 ## 9    0.37196567 -0.025262162 0.4170985 plot_heatmap_features_by_clusters(scMuffinList_demo, feature_source = \"gss\")"},{"path":[]},{"path":"/articles/scMuffin.html","id":"cnv-calculation","dir":"Articles","previous_headings":"CNV inference","what":"CNV calculation","title":"scMuffin package vignettes","text":"CNV inference performed function CNV_analysis. results stored scMuffinList_demo$CNV, summary contains “CNV_signal” scMuffinList_demo$CNV$full$CNV regions--cells CNV matrix; element scMuffinList_demo$CNV$full$regions2genes important map original data CNV regions; lastly, scMuffinList_demo$CNV$full$detected_cnv_regions data.frame list CNV regions detected chromosome cell cluster: Importantly, CNV inference adds “CNV” partition: calculation can demanding. example, requires approximately 10 minutes 2 cores (dual Intel(R) Xeon(R), 2.60GHz).","code":"scMuffinList_demo <- CNV_analysis(scMuffinList_demo) head(scMuffinList_demo$CNV$summary) ##    CNV_signal ## V3   42.63922 ## V4   49.41188 ## V5   40.24116 ## V6   45.47030 ## V7   37.84952 ## V8   45.86847 head(scMuffinList_demo$CNV$full$CNV) ##                                                    V3         V4          V5 ## chr1__LINC00115_826205__UQCRHL_15807161   -0.09649985 -0.1330433 -0.08760797 ## chr1__LINC01128_827797__FLJ37453_15834214 -0.09649985 -0.1330433 -0.08760797 ## chr1__SAMD11_925730__SPEN_15847706        -0.09978001 -0.1363396 -0.08760797 ## chr1__NOC2L_944202__ZBTB17_15941868       -0.09978001 -0.1286003 -0.08760797 ## chr1__HES4_998963__FBXO42_16246839        -0.10306018 -0.1228353 -0.08760797 ## chr1__ISG15_1013496__SZRD1_16367241       -0.10306018 -0.1203667 -0.08760797 ##                                                    V6          V7         V8 ## chr1__LINC00115_826205__UQCRHL_15807161   -0.07987470 -0.09295970 -0.1308550 ## chr1__LINC01128_827797__FLJ37453_15834214 -0.07987470 -0.08965322 -0.1308550 ## chr1__SAMD11_925730__SPEN_15847706        -0.07987470 -0.08965322 -0.1250560 ## chr1__NOC2L_944202__ZBTB17_15941868       -0.07657357 -0.08965322 -0.1217379 ## chr1__HES4_998963__FBXO42_16246839        -0.08234611 -0.09295970 -0.1184198 ## chr1__ISG15_1013496__SZRD1_16367241       -0.07904497 -0.09295970 -0.1151017 ##                                                   V9        V10        V11 ## chr1__LINC00115_826205__UQCRHL_15807161   -0.1360846 -0.1135812 0.03934666 ## chr1__LINC01128_827797__FLJ37453_15834214 -0.1394048 -0.1135812 0.04272745 ## chr1__SAMD11_925730__SPEN_15847706        -0.1360846 -0.1102118 0.04862384 ## chr1__NOC2L_944202__ZBTB17_15941868       -0.1360846 -0.1135812 0.05452022 ## chr1__HES4_998963__FBXO42_16246839        -0.1360846 -0.1135812 0.05703581 ## chr1__ISG15_1013496__SZRD1_16367241       -0.1360846 -0.1102118 0.06041660 ##                                                   V12 ## chr1__LINC00115_826205__UQCRHL_15807161   -0.08363167 ## chr1__LINC01128_827797__FLJ37453_15834214 -0.08363167 ## chr1__SAMD11_925730__SPEN_15847706        -0.08363167 ## chr1__NOC2L_944202__ZBTB17_15941868       -0.08020467 ## chr1__HES4_998963__FBXO42_16246839        -0.08020467 ## chr1__ISG15_1013496__SZRD1_16367241       -0.07423670 head(scMuffinList_demo$CNV$full$regions2genes) ## $chr1__LINC00115_826205__UQCRHL_15807161 ##       symbol location ## 11 LINC00115   826205 ## 12 LINC01128   827797 ## 13    SAMD11   925730 ## 14     NOC2L   944202 ## 15      HES4   998963 ## 16     ISG15  1013496 head(scMuffinList_demo$CNV$full$detected_cnv_regions$chr1) ##     chr                                    start start.loc ## 1  chr1  chr1__LINC00115_826205__UQCRHL_15807161    826205 ## 4  chr1   chr1__HIPK1_113953876__CHTOP_153633981 113953876 ## 9  chr1   chr1__BLZF1_169367878__CHIT1_203216078 169367878 ## 10 chr1  chr1__LINC00115_826205__UQCRHL_15807161    826205 ## 11 chr1  chr1__LRIG2_113073197__S100A6_153534598 113073197 ## 12 chr1 chr1__ALDH9A1_165662215__LMOD1_201896455 165662215 ##                                         stop  stop.loc cluster   length ## 1      chr1__TMEM201_9588910__STMN1_25900115  25900115       0 25073910 ## 4  chr1__RAB13_153981604__C1orf226_162378840 162378840       0 48424964 ## 9    chr1__SLC19A2_169463910__BTG2_203305518 203305518       0 33937640 ## 10      chr1__ZBTB48_6579993__RPL11_23691778  23691778       1 22865573 ## 11      chr1__TPM3_154161812__UAP1_162561439 162561439       1 49488242 ## 12 chr1__METTL18_169792531__ATP2B4_203626831 203626831       1 37964616 head(scMuffinList_demo$partitions) ##    global_expr CNV ## V3           0   2 ## V4           0   3 ## V5           7   0 ## V6           0   3 ## V7           7   0 ## V8           7   1"},{"path":"/articles/scMuffin.html","id":"cnv-visualization","dir":"Articles","previous_headings":"CNV inference","what":"CNV visualization","title":"scMuffin package vignettes","text":"scMuffin provides two visualizations CNVs: heatmap cluster average profile plot. heatmap based ComnplexHeatmap package enables visualization genomic location series given genes (specified argument genes), , alternatively, location detected CNVs (argument mark.detected.cnv = T)  function plot_profile_CNV plots median CNV profile cluster:","code":"col_fun <- circlize::colorRamp2(seq(-0.2, 0.2, length.out = 11), rev(pals::brewer.rdylbu(11))) heatmap_CNV(scMuffinList = scMuffinList_demo, genes = c(\"YBX1\", \"HNRNPM\"), genes.labels = T, col=col_fun)  heatmap_CNV(scMuffinList = scMuffinList_demo, mark.detected.cnv = T, col=col_fun) plot_profile_CNV(scMuffinList = scMuffinList_demo, cluster = 0, cex.points = 0.5)"},{"path":"/articles/scMuffin.html","id":"transcriptional-complexity","dir":"Articles","previous_headings":"","what":"Transcriptional complexity","title":"scMuffin package vignettes","text":"transcriptional complexity can quantified means function transcr_compl. corresponding summary element contains data.frame number cell transcripts, number genes detected every cell, TC-ratio (C), TC-LMR (linear model residual) TC-H (entropy):","code":"scMuffinList_demo <- transcr_compl(scMuffinList_demo) head(scMuffinList_demo$transcr_compl$summary) ##    tot_counts n_genes         C        H          LM ## V3      16228    1051 0.8628900 6.522372 -0.02561130 ## V4      14286    1168 1.0893060 6.736431  0.06164645 ## V5      15857    1217 1.0225564 6.602594  0.04559174 ## V6      15157    1208 1.0618701 6.763307  0.05703916 ## V7      15609    1171 0.9995385 6.535546  0.03398037 ## V8      15286    1218 1.0616250 6.685640  0.05786558"},{"path":"/articles/scMuffin.html","id":"cell-proliferation-rate","dir":"Articles","previous_headings":"","what":"Cell proliferation rate","title":"scMuffin package vignettes","text":"Cell proliferation quantified considering maximum two scores G1/S G2/M gene sets: proliferation score stored summary element scMuffinList_demo$proliferation:","code":"scMuffinList_demo <- proliferation_analysis(scMuffinList_demo) head(scMuffinList_demo$proliferation$summary) ##    Proliferation_score ## V3          0.24639700 ## V4          0.49466334 ## V5         -0.18135986 ## V6          0.35468552 ## V7         -0.07408355 ## V8         -0.11730502"},{"path":"/articles/scMuffin.html","id":"cell-state-trajectories","dir":"Articles","previous_headings":"","what":"Cell state trajectories","title":"scMuffin package vignettes","text":"Diffusion maps identify differentiation trajectories. scMuffin relies diffusion pseudo time calculation available R package “destiny” (Angerer et al. 2016). calculate diffusion map first 50 PC (speed computation), using random cell obtain diffusion pseudotimes: data.frame important features analysis (first two eigenvectors, pseudotime, branch information whether cell tip branch ) stored scMuffinList_demo$diffusion_map_pseudo_t$summary:","code":"scMuffinList_demo <- diff_map(scMuffinList_demo, root_cell = \"random\", n_pcs=50) scMuffinList_demo$diffusion_map_pseudo_t$summary ##            DC1         DC2       dpt branch  tips ## V3 -0.02439247 0.027065472 0.4543284     NA FALSE ## V4 -0.03067862 0.038183692 0.3605517      1 FALSE ## V5  0.01926612 0.005728970 1.3628920      2 FALSE ## V6 -0.03187947 0.047049007 0.3474134      1 FALSE ## V7  0.01855801 0.004949549 1.3447794      2 FALSE ## V8  0.01855621 0.005021415 1.3454328      2 FALSE"},{"path":"/articles/scMuffin.html","id":"cluster-enrichment-assessment","dir":"Articles","previous_headings":"","what":"Cluster enrichment assessment","title":"scMuffin package vignettes","text":"Cell clusters can assessed enrichment quantitative categorical values. appropriate statistical test automatically chosen according feature type. example, assess cluster enrichment feature gene_set_scoring (quantitative one) cluster defined partition global_expr: case quantitative features result list named CSEA, placed elements cluster_data$global_expr (partition id). list contains gene set table leading edge results. ’s result related gene set Angiogenesis: example assess cluster enrichment relation categorical feature, namely cell cycle phase: categorical features result list named ORA, placed elements cluster_data$global_expr (partition id). list contains ORA results every categorical value. ’s enrichment clusters terms cells value “G1”: enrichment analysis results appearing tables can easily extracted organized clusters--values table means extract_cluster_enrichment_table. instance, extract CSEA NES FDRq values, ORA er (enrichment ratio) values: tables can plotted function plot_heatmap_features_by_clusters. following example plot NES values asterisks according significance:  Similarly, ’s possible extract significant “tags” clusters; example, extract top 3 tags FDRq (CSEA) p_adj (ORA): results placed cluster_tags element: results cluster enrichment can visualized barplots boxplots , respectively, categorical values quantitative values.","code":"scMuffinList_demo <- assess_cluster_enrichment(scMuffinList_demo, feature_name = \"gene_set_scoring\", partition_id = \"global_expr\") scMuffinList_demo$cluster_data$global_expr$CSEA$gs_table$Angiogenesis ##   id         es p_val adj_p_val n_pos_perm n_neg_perm       nes        FDRq ## 0  0  0.2551729  0.62 0.8857143        100          0 0.9600786 0.946014127 ## 1  1  0.2674230  0.55 0.8857143        100          0 0.9839195 0.989909183 ## 2  2  0.1910471  1.00 1.0000000        100          0 0.6916231 1.000000000 ## 3  3  0.2711880  0.53 0.8857143         98          2 1.0002714 1.000000000 ## 4  4 -0.2306596  0.01 0.0500000         99          1 0.0000000 1.000000000 ## 5  5  0.2985592  0.26 0.6500000        100          0 1.0816991 0.823410696 ## 6  6  0.2494544  0.82 1.0000000        100          0 0.8571037 1.000000000 ## 7  7  0.6061648  0.01 0.0500000         99          1 2.1895320 0.009081736 ## 8  8  0.4113923  0.05 0.1666667         97          3 1.4228520 0.031786075 ## 9  9  0.1897547  0.98 1.0000000         98          2 0.6366039 0.992936428 scMuffinList_demo <- assess_cluster_enrichment(scMuffinList_demo, feature_name = \"CC_Phase\", partition_id = \"global_expr\") scMuffinList_demo$cluster_data$global_expr$ORA$CC_Phase$G1 ##   id    N   wb  bb  bd wbd       exp       er            p        p_adj ## 0  0 2828 2049 779 499   0 361.54562 0.000000 1.000000e+00 1.000000e+00 ## 1  1 2828 2049 779 475 459 344.15665 1.333695 2.289783e-50 2.289783e-49 ## 2  2 2828 2049 779 378 343 273.87624 1.252391 8.889784e-21 1.777957e-20 ## 3  3 2828 2049 779 309 293 223.88296 1.308720 2.712597e-26 9.041991e-26 ## 4  4 2828 2049 779 296 272 214.46393 1.268279 2.060936e-18 3.434894e-18 ## 5  5 2828 2049 779 257 253 186.20686 1.358704 5.986769e-32 2.993384e-31 ## 6  6 2828 2049 779 185 145 134.03996 1.081767 3.528719e-02 4.410899e-02 ## 7  7 2828 2049 779 172 169 124.62093 1.356112 6.593125e-21 1.648281e-20 ## 8  8 2828 2049 779 142 115 102.88472 1.117756 1.066766e-02 1.523951e-02 ## 9  9 2828 2049 779 115   0  83.32214 0.000000 1.000000e+00 1.000000e+00 csea_fdr_table <- extract_cluster_enrichment_table(scMuffinList_demo,  partition_id = \"global_expr\", type = \"CSEA\", quantity = \"FDRq\") csea_nes_table <- extract_cluster_enrichment_table(scMuffinList_demo,  partition_id = \"global_expr\", type = \"CSEA\", quantity = \"nes\") ora_p_table <- extract_cluster_enrichment_table(scMuffinList_demo,  partition_id = \"global_expr\", type = \"ORA\", quantity = \"p\") csea_fdr_table ##   Angiogenesis  Apoptosis  Cell_Cycle Differentiation  DNA_damage  DNA_repair ## 0  0.946014127 0.00879397 0.003722084      0.02250000 0.690090090 0.004201681 ## 1  0.989909183 0.01470588 1.000000000      0.11800000 0.102102102 1.000000000 ## 2  1.000000000 0.64049414 0.032258065      1.00000000 1.000000000 1.000000000 ## 3  1.000000000 0.09803922 0.032258065      1.00000000 1.000000000 1.000000000 ## 4  1.000000000 0.23743719 0.032258065      1.00000000 1.000000000 1.000000000 ## 5  0.823410696 0.88819095 0.058064516      1.00000000 0.955955956 1.000000000 ## 6  1.000000000 0.01172529 0.579404467      1.00000000 0.009009009 0.111344538 ## 7  0.009081736 0.01470588 0.048387097      0.02666667 1.000000000 0.031250000 ## 8  0.031786075 0.76331658 0.967741935      0.01000000 0.009009009 0.110644258 ## 9  0.992936428 0.00879397 0.003722084      0.01000000 0.315315315 0.004201681 ##           EMT     Hypoxia Inflammation    Invasion  Metastasis Proliferation ## 0 1.000000000 1.000000000  1.000000000 0.007021063 1.000000000   0.005035247 ## 1 0.013513514 0.006024096  0.006079027 0.968906720 0.006024096   1.000000000 ## 2 0.951351351 0.013253012  1.000000000 1.000000000 0.075301205   1.000000000 ## 3 0.012012012 0.952811245  1.000000000 1.000000000 0.065060241   1.000000000 ## 4 0.416666667 0.006024096  0.030395137 1.000000000 0.201807229   0.005035247 ## 5 0.953453453 0.009036145  0.167173252 0.937311936 0.008032129   1.000000000 ## 6 1.000000000 1.000000000  0.954407295 0.546238716 1.000000000   0.992950655 ## 7 0.009009009 0.006024096  0.036474164 0.252758275 0.006024096   1.000000000 ## 8 1.000000000 1.000000000  1.000000000 0.235205617 1.000000000   0.308408862 ## 9 1.000000000 1.000000000  1.000000000 0.007021063 1.000000000   0.005035247 ##    Quiescence    Stemness ## 0 1.000000000 0.007021063 ## 1 0.004454343 1.000000000 ## 2 0.040000000 1.000000000 ## 3 1.000000000 1.000000000 ## 4 0.004454343 0.007021063 ## 5 1.000000000 1.000000000 ## 6 0.040000000 0.007021063 ## 7 0.129175947 1.000000000 ## 8 0.534521158 0.007021063 ## 9 0.040000000 0.007021063 plot_heatmap_features_by_clusters(feature_source = csea_nes_table, significance_matrix = csea_fdr_table, sig_threshold = 0.05) scMuffinList_demo <- extract_cluster_enrichment_tags(scMuffinList_demo, partition_id = \"global_expr\", n_max_per_cluster = 3, CSEA_selection_criterion=\"FDRq\", only_pos_nes = TRUE, CSEA_selection_threshold = 0.05, ORA_selection_criterion = \"p_adj\", ORA_selection_threshold = 0.25) head(scMuffinList_demo$cluster_data$global_expr$cluster_tags$CSEA) ## $`0` ## [1] \"Cell_Cycle\" \"DNA_repair\" \"Invasion\"   ##  ## $`1` ## [1] \"Apoptosis\"    \"Inflammation\" \"Hypoxia\"      ##  ## $`2` ## [1] \"Hypoxia\"    \"Metastasis\" \"EMT\"        ##  ## $`3` ## [1] \"EMT\"        \"Metastasis\" \"Apoptosis\"  ##  ## $`4` ## [1] \"Quiescence\" \"Hypoxia\"    \"Stemness\"   ##  ## $`5` ## [1] \"Metastasis\"   \"Hypoxia\"      \"Inflammation\" barplot_cluster(scMuffinList_demo, partition_id = \"global_expr\", feature_name = \"CC_Phase\", feature_id = \"CC_Phase\") boxplot_cluster(scMuffinList_demo, feature_name = \"gene_set_scoring\", partition_id = \"global_expr\")"},{"path":[]},{"path":"/articles/scMuffin.html","id":"intra-dataset","dir":"Articles","previous_headings":"Comparison between clusters","what":"Intra-dataset","title":"scMuffin package vignettes","text":"function overlap_matrix calculates overlap coefficient -pairs clusters two partitions cells (dataset): results stored element `cluster_comparison```:","code":"scMuffinList_demo <- overlap_matrix(scMuffinList_demo) head(scMuffinList_demo$cluster_comparison$overlap_matrix) ##                     CNV_0       CNV_1     CNV_2     CNV_3       CNV_4 ## CNV_0         1.000000000 0.000000000 0.0000000 0.0000000 0.000000000 ## CNV_1         0.000000000 1.000000000 0.0000000 0.0000000 0.000000000 ## CNV_2         0.000000000 0.000000000 1.0000000 0.0000000 0.000000000 ## CNV_3         0.000000000 0.000000000 0.0000000 1.0000000 0.000000000 ## CNV_4         0.000000000 0.000000000 0.0000000 0.0000000 1.000000000 ## global_expr_0 0.004008016 0.004008016 0.5651303 0.5261845 0.008264463 ##               global_expr_0 global_expr_1 global_expr_2 global_expr_3 ## CNV_0           0.004008016     0.6042105   0.394179894   0.372168285 ## CNV_1           0.004008016     0.3368421   0.531746032   0.559870550 ## CNV_2           0.565130261     0.0000000   0.007936508   0.006472492 ## CNV_3           0.526184539     0.0000000   0.002645503   0.000000000 ## CNV_4           0.008264463     0.1157025   0.099173554   0.078512397 ## global_expr_0   1.000000000     0.0000000   0.000000000   0.000000000 ##               global_expr_4 global_expr_5 global_expr_6 global_expr_7 ## CNV_0            0.14189189   0.657587549    0.00000000     0.7674419 ## CNV_1            0.19594595   0.334630350    0.01621622     0.2325581 ## CNV_2            0.09459459   0.000000000    0.74054054     0.0000000 ## CNV_3            0.02702703   0.000000000    0.22702703     0.0000000 ## CNV_4            0.66115702   0.008264463    0.01621622     0.0000000 ## global_expr_0    0.00000000   0.000000000    0.00000000     0.0000000 ##               global_expr_8 global_expr_9 ## CNV_0           0.007042254   0.000000000 ## CNV_1           0.021126761   0.008695652 ## CNV_2           0.605633803   0.200000000 ## CNV_3           0.345070423   0.782608696 ## CNV_4           0.021126761   0.008695652 ## global_expr_0   0.000000000   0.000000000"},{"path":"/articles/scMuffin.html","id":"inter-dataset","dir":"Articles","previous_headings":"Comparison between clusters","what":"Inter-dataset","title":"scMuffin package vignettes","text":"Inter-dataset comparison performed function inter_dataset_comparison, require list Seurat objects gene set list. activity gene set list assessed clusters datasets. needed, function prepare_cluster_markers_list provides possibility prepare gene set list cluster markers, starting  function can used analyze gene set. following example assess expression CancerSEA gene sets across datasets: caption","code":"dataset_cmp_res <- inter_dataset_comparison(seu_obj_list = seu_obj_list, gsl = cluster_markers_list, genes_max = 500, genes_min = 5) plot_heatmap_dataset_comparison(dataset_cmp_res, outfile = \"vignette/heatmap_ds_cmp.png\") plot_heatmap_dataset_comparison(dataset_cmp_res, outfile = \"vignette/heatmap_ds_cmp_p.png\", type = \"significance\") gsl <- prepare_gsls(gs_sources = \"CancerSEA\", genes=unlist(lapply(seu_obj_list, rownames))) dataset_cmp_res_cancersea <- inter_dataset_comparison(seu_obj_list = seu_obj_list, gsl = gsl$CancerSEA, genes_max = 500, genes_min = 5) plot_heatmap_dataset_comparison(dataset_cmp_res_cancersea, outfile = \"vignette/heatmap_ds_cmp_cancer.png\")"},{"path":[]},{"path":"/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Valentina Nale. Author. Noemi Di Nanni. Author. Alice Chiodi. Author. Ettore Mosca. Author, maintainer.","code":""},{"path":"/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Nale V, Di Nanni N, Chiodi , Mosca E (2023). scMuffin: MUlti-Features INtegrative approach single-cell data analysis. R package version 1.1.0.","code":"@Manual{,   title = {scMuffin: MUlti-Features INtegrative approach for single-cell data analysis},   author = {Valentina Nale and Noemi {Di Nanni} and Alice Chiodi and Ettore Mosca},   year = {2023},   note = {R package version 1.1.0}, }"},{"path":"/index.html","id":"scmuffin---a-multi-features-integrative-approach-for-sc-data-analysis","dir":"","previous_headings":"","what":"MUlti-Features INtegrative approach for single-cell data analysis","title":"MUlti-Features INtegrative approach for single-cell data analysis","text":"Single-cell (SC) gene expression analysis crucial dissect complex cellular heterogeneity solid tumors, one main obstacles development effective cancer treatments. tumors typically contain mixture cells aberrant genomic transcriptomic profiles affecting specific sub-populations might pivotal role cancer progression, whose identification eludes bulk RNA-sequencing approaches. scMuffin R package enables characterization cell identity solid tumors basis various complementary analyses SC gene expression data, : gene set expression (cell-level cluster level); CNV inferece; transcriptional complexity; cell state trajectories; proliferation state; cluster enrichment assessment (quantitative categorical values). Typical applications scMuffin include: characterize expression cells clusters; distinguish normal tumoral cells; associate clusters phenotypes; define cell identities; cluster cells different ways; link genomic aberrations phenotypes; identify subtle differences cell subtypes cell states; compare datasets based gene set expression. Documentation: https://emosca-cnr.github.io/scMuffin Source code: https://github.com/emosca-cnr/scMuffin Citation: https://www.biorxiv.org/content/10.1101/2022.06.01.494129v1 Contacts: Ettore Mosca, Bioinformatics Lab, CNR-ITB Paride Pelucchi, Stem Cell Biology Cancer Lab, CNR-ITB","code":""},{"path":"/reference/CNV.html","id":null,"dir":"Reference","previous_headings":"","what":"CNV — CNV","title":"CNV — CNV","text":"Function used calculate_CNV.","code":""},{"path":"/reference/CNV.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"CNV — CNV","text":"","code":"CNV(x, wnd_size = 100, na.rm = FALSE)"},{"path":"/reference/CNV.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"CNV — CNV","text":"x list dataframes retrieved 'preprocess_object_for_cnv'. wnd_size number adjacent genes consider na.rm whether remove genes missing value expression .","code":""},{"path":"/reference/CNV.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"CNV — CNV","text":"\"Single-cell RNA-seq highlights intratumoral heterogeneity primary glioblastoma\" Patel et al., Supplementary materials","code":""},{"path":"/reference/CNV.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"CNV — CNV","text":"Valentina Nale","code":""},{"path":"/reference/CNV_analysis.html","id":null,"dir":"Reference","previous_headings":"","what":"CNV analysis — CNV_analysis","title":"CNV analysis — CNV_analysis","text":"CNV analysis","code":""},{"path":"/reference/CNV_analysis.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"CNV analysis — CNV_analysis","text":"","code":"CNV_analysis(   scMuffinList = NULL,   mc.cores = 1,   reference = NULL,   min_cells = 100,   min_genes = 100,   wnd_size = 100,   scale_cells = TRUE,   center_genes = FALSE,   expr_lim = FALSE,   method = \"mean\",   na.rm = FALSE,   z.score = FALSE,   eps = NULL )"},{"path":"/reference/CNV_analysis.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"CNV analysis — CNV_analysis","text":"scMuffinList scMuffinList object mc.cores number cores; reference one-column data.frame reference expression profile; rownames must match genes_by_cell; min_cells minimum numbver cells gene must expressed; min_genes minimun number genes expressed cell; wnd_size number adjacent genes considered; scale_cells whether scale cells center_genes whether center genes expr_lim min max values relative expression; default, lower higher whiskers returned grDevices::boxplot.stats used. Set NA anything value length(expr_lim) != 2 disbale removal outliers. method mean: subtract average profile reference cluster every cell; min_max see Tirosh et al. na.rm whether remove 0 values CNV estimation z.score whether use z-scores cluster median CNV profile, instead median . eps absolute threshold call CNV regions.","code":""},{"path":"/reference/add_features.html","id":null,"dir":"Reference","previous_headings":"","what":"Add a feature to scMuffinList — add_features","title":"Add a feature to scMuffinList — add_features","text":"Add feature scMuffinList","code":""},{"path":"/reference/add_features.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add a feature to scMuffinList — add_features","text":"","code":"add_features(scMuffinList = NULL, name = NULL, summary = NULL, full = NULL)"},{"path":"/reference/add_features.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add a feature to scMuffinList — add_features","text":"scMuffinList scMuffinList object name feature name summary data.frame cell identifiers row.names full optional information related feature, like cell-level statistics","code":""},{"path":"/reference/add_features.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Add a feature to scMuffinList — add_features","text":"scMuffinList additional feature","code":""},{"path":"/reference/add_partitions.html","id":null,"dir":"Reference","previous_headings":"","what":"Adds a clustering to the clustering list — add_partitions","title":"Adds a clustering to the clustering list — add_partitions","text":"Add partition set partitions","code":""},{"path":"/reference/add_partitions.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Adds a clustering to the clustering list — add_partitions","text":"","code":"add_partitions(scMuffinList = NULL, clusters = NULL, partition_id = NULL)"},{"path":"/reference/add_partitions.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Adds a clustering to the clustering list — add_partitions","text":"scMuffinList scMuffinList object clusters named factor values cells names names cluster labels partition_id unique identifier partition","code":""},{"path":"/reference/add_partitions.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Adds a clustering to the clustering list — add_partitions","text":"scMuffinList additional partition","code":""},{"path":"/reference/adj_outliers_col.html","id":null,"dir":"Reference","previous_headings":"","what":"Remove outliers to avoid that these influence colors — adj_outliers_col","title":"Remove outliers to avoid that these influence colors — adj_outliers_col","text":"definition outliers based function 'boxplot.stats()'. Values x lower extreme lower whisker set equal ; values x greater exteme upper whisker set equal .","code":""},{"path":"/reference/adj_outliers_col.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Remove outliers to avoid that these influence colors — adj_outliers_col","text":"","code":"adj_outliers_col(x)"},{"path":"/reference/adj_outliers_col.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Remove outliers to avoid that these influence colors — adj_outliers_col","text":"x numeric vector","code":""},{"path":"/reference/apply_CNV_reference.html","id":null,"dir":"Reference","previous_headings":"","what":"apply_CNV_reference — apply_CNV_reference","title":"apply_CNV_reference — apply_CNV_reference","text":"Add reference vector CNV matrix","code":""},{"path":"/reference/apply_CNV_reference.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"apply_CNV_reference — apply_CNV_reference","text":"","code":"apply_CNV_reference(   cnv = NULL,   cnv_clustering = NULL,   reference = \"reference\",   eps = 0.2,   method = c(\"mean\", \"min_max\") )"},{"path":"/reference/apply_CNV_reference.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"apply_CNV_reference — apply_CNV_reference","text":"cnv output calculate_CNV cnv_clustering output cluster_by_features(..., cnv=TRUE, ...) reference name reference column eps threshold min_max method method mean (default): subtract average profile reference cluster every cell; min_max see Tirosh et al. 10.1126/science.aad0501. min_max method values () maximum (minimum) reference cluster + (-) eps set 0. lower (upper) extreme whisker considered minimum (maximum) values.","code":""},{"path":"/reference/assess_cluster_enrichment.html","id":null,"dir":"Reference","previous_headings":"","what":"Assess enrichment with ORA or CSEA — assess_cluster_enrichment","title":"Assess enrichment with ORA or CSEA — assess_cluster_enrichment","text":"Assess cluster enrichment using ORA categorical features CSEA numeric features.","code":""},{"path":"/reference/assess_cluster_enrichment.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Assess enrichment with ORA or CSEA — assess_cluster_enrichment","text":"","code":"assess_cluster_enrichment(   scMuffinList = NULL,   feature_name = NULL,   partition_id = NULL,   min.cells.feature = 100,   min.cells.cluster = 10,   mc.cores = 1,   csea.k = 99 )"},{"path":"/reference/assess_cluster_enrichment.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Assess enrichment with ORA or CSEA — assess_cluster_enrichment","text":"scMuffinList scMuffinList list feature_name names feature considered. must one names(scMuffinList) partition_id identifier partition considered min.cells.feature minimum number cells feature must value min.cells.cluster minimum number cells cluster mc.cores number cores csea.k number CSEA permutations","code":""},{"path":"/reference/assess_cluster_enrichment.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Assess enrichment with ORA or CSEA — assess_cluster_enrichment","text":"scMuffinList CSEA ORA elements scMuffinList$cluster_data considered partition","code":""},{"path":"/reference/assess_cluster_enrichment.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Assess enrichment with ORA or CSEA — assess_cluster_enrichment","text":"output CSEA table statistics every tested gene set (gs_table element) table results leading edge (leading_edge element).  output ORA composed series tables enrichment results, one every possible categorical value. See [extract_cluster_enrichment_table] extract summary table CSEA ORA results.","code":""},{"path":"/reference/barplot_cluster.html","id":null,"dir":"Reference","previous_headings":"","what":"Barplot clusters — barplot_cluster","title":"Barplot clusters — barplot_cluster","text":"Produce boxplots given features cluster. t-test performed feature among clusters.","code":""},{"path":"/reference/barplot_cluster.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Barplot clusters — barplot_cluster","text":"","code":"barplot_cluster(   scMuffinList = NULL,   feature_name = NULL,   feature_id = NULL,   partition_id = NULL,   dir_out = \"./\",   n_features = 10,   only_pos_nes = TRUE,   cex.axis = 0.8,   p.type = c(\"p\", \"p_adj\"),   width = 180,   height = 180,   units = \"mm\",   res = 300 )"},{"path":"/reference/barplot_cluster.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Barplot clusters — barplot_cluster","text":"scMuffinList scMuffinList object feature_name name features used. feature_id identifier feature used. partition_id one among partitions dir_out string, output directory n_features maximum number features shown only_pos_nes whether consider positive enrichments cex.axis cex.axis p.type p nominal p-value p_adj BH FDR. width image width height image height units image units res image resolution","code":""},{"path":"/reference/boxplot_cluster.html","id":null,"dir":"Reference","previous_headings":"","what":"Boxplot clusters — boxplot_cluster","title":"Boxplot clusters — boxplot_cluster","text":"Produce boxplots given features cluster. t-test performed feature among clusters.","code":""},{"path":"/reference/boxplot_cluster.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Boxplot clusters — boxplot_cluster","text":"","code":"boxplot_cluster(   scMuffinList = NULL,   feature_name = NULL,   partition_id = NULL,   dir_out = \"./\",   n_features = 10,   only_pos_nes = TRUE,   do_scale_features = FALSE,   cex.axis = 0.8,   width = 180,   height = 180,   units = \"mm\",   res = 300 )"},{"path":"/reference/boxplot_cluster.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Boxplot clusters — boxplot_cluster","text":"scMuffinList scMuffinList object feature_name names feature considered. must one names(scMuffinList) partition_id one among partitions dir_out output directory n_features maximum number features shown only_pos_nes whether consider positive enrichments do_scale_features whether scale features cex.axis cex.axis width image width height image height units image units res image resolution","code":""},{"path":"/reference/boxplot_points.html","id":null,"dir":"Reference","previous_headings":"","what":"Boxplot with points — boxplot_points","title":"Boxplot with points — boxplot_points","text":"Boxplot points","code":""},{"path":"/reference/boxplot_points.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Boxplot with points — boxplot_points","text":"","code":"boxplot_points(   x = NULL,   f = NULL,   col = NULL,   amount = 0.2,   adj.col = 1,   pch = 16,   cex = 0.6,   ylim = NULL,   file = NULL,   width = 180,   height = 180,   units = \"mm\",   res = 300,   image_format = \"png\",   ... )"},{"path":"/reference/boxplot_points.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Boxplot with points — boxplot_points","text":"x values f factor split values col color palette. Equal length levels(f) amount amount jitter adj.col color adjustment pch point pch cex cex ylim ylim file output file width image width height image height units image units res image resolution image_format png jpeg ... argument boxplot","code":""},{"path":"/reference/calc_gs_perm.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate permutations — calc_gs_perm","title":"Calculate permutations — calc_gs_perm","text":"Calculate permutations","code":""},{"path":"/reference/calc_gs_perm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate permutations — calc_gs_perm","text":"","code":"calc_gs_perm(rll, perm, gs)"},{"path":"/reference/calc_gs_perm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate permutations — calc_gs_perm","text":"rll numeric matrix genes--ranking criteria; column contains numeric values; rownames mandatory perm vector permuted names gs gene set","code":""},{"path":"/reference/calculate_CNV.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate CNV — calculate_CNV","title":"Calculate CNV — calculate_CNV","text":"Calculate CNV using moving average approach firstly described Patel et al., 2014 Science (DOI: 10.1126/science)","code":""},{"path":"/reference/calculate_CNV.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate CNV — calculate_CNV","text":"","code":"calculate_CNV(   genes_by_cells,   reference = NULL,   mc.cores = 1,   wnd_size = 100,   min_genes = 1000,   min_cells = 100,   expr_lim = NULL,   scale_cells = TRUE,   na.rm = FALSE,   center_genes = FALSE )"},{"path":"/reference/calculate_CNV.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate CNV — calculate_CNV","text":"genes_by_cells genes--cells data.frame reference one-column data.frame reference expression profile; rownames must match genes_by_cell; mc.cores number cores; wnd_size number adjacent genes considered; min_genes minimun number genes expressed cell; min_cells minimum numbver cells gene must expressed; expr_lim min max values relative expression; default, lower higher whiskers returned grDevices::boxplot.stats used. Set NA anything value length(expr_lim) != 2 disbale removal outliers. scale_cells whether scale cells na.rm whether remove 0 values CNV estimation center_genes whether center genes ","code":""},{"path":"/reference/calculate_gs_scores.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate gene set scores — calculate_gs_scores","title":"Calculate gene set scores — calculate_gs_scores","text":"Calculate gene set scores using approach described Tirosh2016","code":""},{"path":"/reference/calculate_gs_scores.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate gene set scores — calculate_gs_scores","text":"","code":"calculate_gs_scores(   scMuffinList = NULL,   gs_list = NULL,   mc.cores = 1,   nbins = 25,   nmark_min = 5,   ncells_min = 10,   k = 100,   kmin = 50,   score_type = c(\"relative\", \"mean\"),   null_model = TRUE,   verbose = TRUE,   na.rm = TRUE,   overwrite = FALSE )"},{"path":"/reference/calculate_gs_scores.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate gene set scores — calculate_gs_scores","text":"scMuffinList scMuffinList object gs_list list gene sets mc.cores number cores nbins number bins split distribution average gene expression nmark_min number minimum markers required succesful calculation gene set score ncells_min number minimum cells gene set succesfully calculated k number permutations kmin minimum number permutations; due missing values hard ensure gene set score can compared k permutations every cell score_type type score. \"relative\", score difference observed gene set average expression k permutations; \"mean\" score equal observed gene set average expression null_model TRUE permutations used. Required score_type=\"relative\" verbose verbosity na.rm whether use NA overwrite whether update gene_set_scoring gene_set_scoring_full elements scMuffinList.","code":""},{"path":"/reference/calculate_gs_scores.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate gene set scores — calculate_gs_scores","text":"scMuffinList element gene_set_scoring, list contains summary full. element summary contains cells--gene sets data.frame. element \"full\" contains data.frame gene set. See [gs_score()] details.","code":""},{"path":"/reference/calculate_gs_scores.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Calculate gene set scores — calculate_gs_scores","text":"Tirosh2016 10.1126/science.aad0501","code":""},{"path":"/reference/calculate_gs_scores_in_clusters.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate gene set score at cluster level — calculate_gs_scores_in_clusters","title":"Calculate gene set score at cluster level — calculate_gs_scores_in_clusters","text":"Calculate gene set score cluster level","code":""},{"path":"/reference/calculate_gs_scores_in_clusters.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate gene set score at cluster level — calculate_gs_scores_in_clusters","text":"","code":"calculate_gs_scores_in_clusters(   scMuffinList = NULL,   partition_id = NULL,   ncells_min = 5,   null_model = TRUE,   alt = \"g\",   test = \"t\" )"},{"path":"/reference/calculate_gs_scores_in_clusters.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate gene set score at cluster level — calculate_gs_scores_in_clusters","text":"scMuffinList scMuffinList object partition_id identifier partition used ncells_min minimum number cells required calculation average signature cluster null_model TRUE consider empirical null based gene set permutations alt alterative passed [wilcox.test()] [t.test()] test type test: t use [t.test()]; wrs use [wilcox.test()]","code":""},{"path":"/reference/calculate_gs_scores_in_clusters.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate gene set score at cluster level — calculate_gs_scores_in_clusters","text":"scMuffinList cluster level scores `sMuffinList$cluster_data[[partition_id]]`. element [summary] contains clusters--gene sets table, element [full] full result","code":""},{"path":"/reference/cluster_by_features.html","id":null,"dir":"Reference","previous_headings":"","what":"Cluster by features — cluster_by_features","title":"Cluster by features — cluster_by_features","text":"Clustering features_by_cell matrix","code":""},{"path":"/reference/cluster_by_features.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Cluster by features — cluster_by_features","text":"","code":"cluster_by_features(   features,   n_comp = 10,   cnv = FALSE,   plot_umap = FALSE,   out_dir = \"./\",   scale_features = TRUE,   ... )"},{"path":"/reference/cluster_by_features.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Cluster by features — cluster_by_features","text":"features features object result CNV calculation n_comp numeric, Dimensions reduction use input cnv TRUE/FALSE set TRUE clustering CNV results plot_umap whether plot UMAP out_dir output directory scale_features whether scale features ... arguments passed Seurat::DimPlot","code":""},{"path":"/reference/cluster_by_features.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Cluster by features — cluster_by_features","text":"features_by_cells Seurat Object, object saved dimension reduction components calculate features cells matrix","code":""},{"path":"/reference/cluster_csea.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate cluster enrichment by means of CSEA — cluster_csea","title":"Calculate cluster enrichment by means of CSEA — cluster_csea","text":"Calculate cluster enrichment csea approach","code":""},{"path":"/reference/cluster_csea.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate cluster enrichment by means of CSEA — cluster_csea","text":"","code":"cluster_csea(   feature_values = NULL,   cell_clusters = NULL,   min.cells.feature = 100,   min.cells.cluster = 10,   mc.cores = 1,   csea.k = 99,   min.k.nes = 10 )"},{"path":"/reference/cluster_csea.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate cluster enrichment by means of CSEA — cluster_csea","text":"feature_values matrix, features cells matrix cell_clusters array cell values named cluster ID min.cells.feature minimum number cells feature must value min.cells.cluster minimum number cells cluster mc.cores number cores csea.k number permutations min.k.nes minimum number null NES values","code":""},{"path":"/reference/cluster_csea.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate cluster enrichment by means of CSEA — cluster_csea","text":"list two elements: gs_table leading_edge. See [csea()]","code":""},{"path":"/reference/cluster_csea.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Calculate cluster enrichment by means of CSEA — cluster_csea","text":"Ettore Mosca","code":""},{"path":"/reference/cluster_gsea.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate cluster enrichment by means of GSEA — cluster_gsea","title":"Calculate cluster enrichment by means of GSEA — cluster_gsea","text":"Calculate cluster enrichment gsea approach","code":""},{"path":"/reference/cluster_gsea.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate cluster enrichment by means of GSEA — cluster_gsea","text":"","code":"cluster_gsea(   feature_values = NULL,   cell_clusters = NULL,   min.cells.feature = 100,   min.cells.cluster = 10,   mc.cores = 1,   gsea.k = 99,   min.k.nes = 10 )"},{"path":"/reference/cluster_gsea.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate cluster enrichment by means of GSEA — cluster_gsea","text":"feature_values matrix, features cells matrix cell_clusters array cell values named cluster ID min.cells.feature minimum number cells feature must value min.cells.cluster minimum number cells cluster mc.cores number cores gsea.k number permutations","code":""},{"path":"/reference/cluster_gsea.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate cluster enrichment by means of GSEA — cluster_gsea","text":"list two elements: gs_table leading_edge. See [gsea()]","code":""},{"path":"/reference/cluster_gsea.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Calculate cluster enrichment by means of GSEA — cluster_gsea","text":"Ettore Mosca","code":""},{"path":"/reference/cluster_hyper.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate cluster enrichment by hypergeometric test — cluster_hyper","title":"Calculate cluster enrichment by hypergeometric test — cluster_hyper","text":"Calculate cluster enrichment categorical values feature, means hypergeometric test","code":""},{"path":"/reference/cluster_hyper.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate cluster enrichment by hypergeometric test — cluster_hyper","text":"","code":"cluster_hyper(feature_values = NULL, cell_clusters = NULL)"},{"path":"/reference/cluster_hyper.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate cluster enrichment by hypergeometric test — cluster_hyper","text":"feature_values matrix, cells--features cell_clusters array cell values named cluster ID","code":""},{"path":"/reference/cluster_hyper.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate cluster enrichment by hypergeometric test — cluster_hyper","text":"list data.frames, one categorical value. See [ora()]","code":""},{"path":"/reference/cluster_stats.html","id":null,"dir":"Reference","previous_headings":"","what":"Cell cluster statistics — cluster_stats","title":"Cell cluster statistics — cluster_stats","text":"Calculate mean variance partition id feature id","code":""},{"path":"/reference/cluster_stats.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Cell cluster statistics — cluster_stats","text":"","code":"cluster_stats(   scMuffinList = NULL,   partition_id = NULL,   feature_name = NULL,   mean_f = mean,   var_f = sd,   na.rm = TRUE )"},{"path":"/reference/cluster_stats.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Cell cluster statistics — cluster_stats","text":"scMuffinList scMuffinList object partition_id partition id feature_name feature name mean_f function use average var_f function use variability na.rm whether remove na ","code":""},{"path":"/reference/cluster_stats.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Cell cluster statistics — cluster_stats","text":"scMuffinList data.frames \"mean\" \"var\" added \"scMuffinList$cluster_data[[partition_id]]\"","code":""},{"path":"/reference/create_features_obj.html","id":null,"dir":"Reference","previous_headings":"","what":"Create feature list — create_features_obj","title":"Create feature list — create_features_obj","text":"Create feature list","code":""},{"path":"/reference/create_features_obj.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create feature list — create_features_obj","text":"","code":"create_features_obj(x = NULL)"},{"path":"/reference/create_features_obj.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create feature list — create_features_obj","text":"x data.frame 1 cell values cell id row names","code":""},{"path":"/reference/create_scMuffinList.html","id":null,"dir":"Reference","previous_headings":"","what":"Create scMuffinList — create_scMuffinList","title":"Create scMuffinList — create_scMuffinList","text":"Create scMuffinList counts /normalized data. gene identifiers must . Note CNV analysis currently available symbols gene identifiers.","code":""},{"path":"/reference/create_scMuffinList.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create scMuffinList — create_scMuffinList","text":"","code":"create_scMuffinList(counts = NULL, normalized = NULL)"},{"path":"/reference/create_scMuffinList.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create scMuffinList — create_scMuffinList","text":"counts genes--cells matrix data.frame counts. Rownames must gene identifiers. normalized genes--cells matrix data.frame normalized expression. Rownames must gene identifiers.","code":""},{"path":"/reference/create_scMuffinList.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create scMuffinList — create_scMuffinList","text":"scMuffinList counts normalized elements dgCMatrix.","code":""},{"path":"/reference/csea.html","id":null,"dir":"Reference","previous_headings":"","what":"Gene Set Enrichment Analysis — csea","title":"Gene Set Enrichment Analysis — csea","text":"Gene Set Enrichment Analysis","code":""},{"path":"/reference/csea.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Gene Set Enrichment Analysis — csea","text":"","code":"csea(   rl,   gsl,   k = 100,   min.size = 100,   ord.mode = -1,   min.k.nes = 10,   mc_cores_path = 1,   mc_cores_perm = 1 )"},{"path":"/reference/csea.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Gene Set Enrichment Analysis — csea","text":"rl numeric matrix genes--ranking criteria; column contains numeric values; rownames mandatory gsl named list gene sets k number permutations min.size minimum number cells null value ord.mode ordering mode: -1 -> descending; 1 ascending; must length equal `ncol(rl)` min.k.nes minimum number null NES values mc_cores_path number cores use parallel calculation gene set lists; total number cpu used mc_cores_path x mc_cores_perm mc_cores_perm number cores use parallel calculation ranked list permutations; total number cpu used mc_cores_path x mc_cores_perm","code":""},{"path":"/reference/csea.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Gene Set Enrichment Analysis — csea","text":"list two data.frames, gs_table leading_edge. gs_table contains: es, enrichment score; nes normalized enrichment score; p-value, empirical p-value; adjusted p-value, BH FDR; FDR q-value, empirical FDR. leading_edge contains: tags, leading edge size; tags_perc, leading edge size percent gene set; list_top, rank ES; list_top_perc, rank ES percent full ranked list; lead_edge, gene names leading edge.","code":""},{"path":"/reference/detect_CNV_regions.html","id":null,"dir":"Reference","previous_headings":"","what":"Detect CNV regions — detect_CNV_regions","title":"Detect CNV regions — detect_CNV_regions","text":"Plot heatmap CNV.","code":""},{"path":"/reference/detect_CNV_regions.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Detect CNV regions — detect_CNV_regions","text":"","code":"detect_CNV_regions(scMuffinList = NULL, z.score = FALSE, eps = NULL)"},{"path":"/reference/detect_CNV_regions.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Detect CNV regions — detect_CNV_regions","text":"scMuffinList scMuffinList object z.score whether use clustere median z-scores CNV signal (TRUE) cluster median CNV signal (FALSE). eps value defines CNV. NUll stard deviation dataset used.","code":""},{"path":"/reference/detect_CNV_regions.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Detect CNV regions — detect_CNV_regions","text":"CNV Profile every cluster","code":""},{"path":"/reference/diff_map.html","id":null,"dir":"Reference","previous_headings":"","what":"Computation of of Diffusion Map and Diffusion Pseudo Time — diff_map","title":"Computation of of Diffusion Map and Diffusion Pseudo Time — diff_map","text":"functions computes Diffusion Map Diffusion Pseudo Time using package destiny.","code":""},{"path":"/reference/diff_map.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Computation of of Diffusion Map and Diffusion Pseudo Time — diff_map","text":"","code":"diff_map(scMuffinList = NULL, root_cell = \"random\", n_pcs = 50, ...)"},{"path":"/reference/diff_map.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Computation of of Diffusion Map and Diffusion Pseudo Time — diff_map","text":"scMuffinList scMuffinList object root_cell root cell \"random\" pick random root via destiny::random_root function n_pcs number PCs consider, 50 default ... parameters passed destiny::DiffusionMap","code":""},{"path":"/reference/diff_map.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Computation of of Diffusion Map and Diffusion Pseudo Time — diff_map","text":"scMuffinList element \"diffusion_map_pseudo_t\", list summary full. summary data.frame : first two eigenvectors; branch, branch label cell; tips, whether cell tip branching. full contains dpt object, generated [destiny::DPT()]. See destiny information.","code":""},{"path":"/reference/es.html","id":null,"dir":"Reference","previous_headings":"","what":"Enrichment Score — es","title":"Enrichment Score — es","text":"Enrichment score","code":""},{"path":"/reference/es.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Enrichment Score — es","text":"","code":"es(idx, x, le = F)"},{"path":"/reference/es.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Enrichment Score — es","text":"idx vector indices subset elements x x named vector, ranked list le leading edge information","code":""},{"path":"/reference/es.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Enrichment Score — es","text":"enrichment score","code":""},{"path":"/reference/extract_cluster_enrichment_table.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract cluster enrichment table — extract_cluster_enrichment_table","title":"Extract cluster enrichment table — extract_cluster_enrichment_table","text":"Extract cluster enrichment table desired quantity results generated means [assess_cluster_enrichment()]","code":""},{"path":"/reference/extract_cluster_enrichment_table.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract cluster enrichment table — extract_cluster_enrichment_table","text":"","code":"extract_cluster_enrichment_table(   scMuffinList,   partition_id = NULL,   type = NULL,   quantity = NULL,   feature_id = NULL )"},{"path":"/reference/extract_cluster_enrichment_table.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract cluster enrichment table — extract_cluster_enrichment_table","text":"scMuffinList scMuffinList object partition_id id partition used type \"CSEA\" \"ORA\" quantity possible values follows. CSEA: es, enrichment score; p_val empirical p-value; adj_p_val, FDR (BH); nes normalized enrichment score; FDRq empirical FDR. ORA: wbd (white balls drawn), number cells value interest cluster; exp expected number cells value interest cluster; er, enrichment ratio; p, hypergeometric test p-value; p_adj, BH FDR feature_id name features considered. Must `colnames(scMuffinList$cluster_data$[[parition_id]]$CSEA$gs_table)` `names(scMuffinList$cluster_data$[[parition_id]]$ORA)`","code":""},{"path":"/reference/extract_cluster_enrichment_table.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract cluster enrichment table — extract_cluster_enrichment_table","text":"cluster enrichment table desired quantity","code":""},{"path":"/reference/extract_cluster_enrichment_tags.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract the top results of CSEA and ORA for each cluster — extract_cluster_enrichment_tags","title":"Extract the top results of CSEA and ORA for each cluster — extract_cluster_enrichment_tags","text":"Extract best results CSEA ORA cluster.","code":""},{"path":"/reference/extract_cluster_enrichment_tags.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract the top results of CSEA and ORA for each cluster — extract_cluster_enrichment_tags","text":"","code":"extract_cluster_enrichment_tags(   scMuffinList = NULL,   partition_id = NULL,   CSEA_selection_criterion = \"FDRq\",   CSEA_selection_threshold = 0.25,   only_pos_nes = TRUE,   ORA_selection_criterion = \"p_adj\",   ORA_selection_threshold = 0.1,   n_max_per_cluster = 3 )"},{"path":"/reference/extract_cluster_enrichment_tags.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract the top results of CSEA and ORA for each cluster — extract_cluster_enrichment_tags","text":"scMuffinList scMuffinList object. partition_id one among partitions. CSEA_selection_criterion selection criteria results CSEA. See extract_cluster_enrichment_table possible values. CSEA_selection_threshold threshold selection tags CSEA. only_pos_nes whether positive nes considered CSEA. ORA_selection_criterion selection criteria results ORA. See extract_cluster_enrichment_table possible values. ORA_selection_threshold threshold selection tags ORA. n_max_per_cluster maximum number tags per cluster.","code":""},{"path":"/reference/extract_cluster_enrichment_tags.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract the top results of CSEA and ORA for each cluster — extract_cluster_enrichment_tags","text":"Add overwrite \"cluster_tags\" list `scMuffinList$cluster_data[[partition_id]]`","code":""},{"path":"/reference/filter_gsl.html","id":null,"dir":"Reference","previous_headings":"","what":"Filter a gene set list — filter_gsl","title":"Filter a gene set list — filter_gsl","text":"Filter gene set list","code":""},{"path":"/reference/filter_gsl.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Filter a gene set list — filter_gsl","text":"","code":"filter_gsl(gsl, universe, min_size = 5, max_size = 500)"},{"path":"/reference/filter_gsl.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Filter a gene set list — filter_gsl","text":"gsl gene set list (named list) universe set possible values items gsl min_size minimum gene set size max_size maximum gene set size","code":""},{"path":"/reference/filter_gsl.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Filter a gene set list — filter_gsl","text":"Filtered gene set list","code":""},{"path":"/reference/genes_in_detected_CNV_regions.html","id":null,"dir":"Reference","previous_headings":"","what":"Retrieve genes in detected CNV regions — genes_in_detected_CNV_regions","title":"Retrieve genes in detected CNV regions — genes_in_detected_CNV_regions","text":"Retrieve genes detected CNV regions","code":""},{"path":"/reference/genes_in_detected_CNV_regions.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Retrieve genes in detected CNV regions — genes_in_detected_CNV_regions","text":"","code":"genes_in_detected_CNV_regions(scMuffinList = NULL)"},{"path":"/reference/genes_in_detected_CNV_regions.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Retrieve genes in detected CNV regions — genes_in_detected_CNV_regions","text":"scMuffinList scMuffinList object","code":""},{"path":"/reference/get_msigdb_geneset.html","id":null,"dir":"Reference","previous_headings":"","what":"Returns msigdb geneset in a format compatible with calculate_signatures() — get_msigdb_geneset","title":"Returns msigdb geneset in a format compatible with calculate_signatures() — get_msigdb_geneset","text":"Returns msigdb geneset format compatible calculate_signatures()","code":""},{"path":"/reference/get_msigdb_geneset.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Returns msigdb geneset in a format compatible with calculate_signatures() — get_msigdb_geneset","text":"","code":"get_msigdb_geneset(   species,   category = NULL,   subcategory = NULL,   type = \"gene_symbol\" )"},{"path":"/reference/get_msigdb_geneset.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Returns msigdb geneset in a format compatible with calculate_signatures() — get_msigdb_geneset","text":"species Species name category MSigDB category name, see msigdbr_collections() subcategory MsigDB subcategory name, see msigdbr_collections() type Gene name interest, can gene_symbol entrez_gene","code":""},{"path":"/reference/get_msigdb_geneset.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Returns msigdb geneset in a format compatible with calculate_signatures() — get_msigdb_geneset","text":"List msigdb_output, output msigdbr::msigdbr, path_list, list gene sets","code":""},{"path":"/reference/gs_score.html","id":null,"dir":"Reference","previous_headings":"","what":"Gene set scoring — gs_score","title":"Gene set scoring — gs_score","text":"Calculate gene set scores using approach described Tirosh2016","code":""},{"path":"/reference/gs_score.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Gene set scoring — gs_score","text":"","code":"gs_score(   gene_set = NULL,   genes_by_cells = NULL,   bins = NULL,   nmark_min = 5,   ncells_min = 5,   k = 100,   kmin = 50,   verbose = TRUE,   null_model = TRUE,   na.rm = TRUE )"},{"path":"/reference/gs_score.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Gene set scoring — gs_score","text":"gene_set gene set genes_by_cells real data bins random data nmark_min min number markers ncells_min min number cells k number random gene set considered kmin minimim number k verbose verbosity null_model boolean, whether use permutations na.rm whether remove missing values","code":""},{"path":"/reference/gs_score.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Gene set scoring — gs_score","text":"data.frame following columns: case, gene set average observed cell; case.N, number genes gene set; case.AV, number genes available cell; nmark_min, whether case.AV > nmark_min; avg_control, average averag gene set score control cells; control.AV, number available control cells, null_ok, whether null defined cell; avg_delta_score, average case minu control cell; delta_score, case - avg_control.","code":""},{"path":"/reference/gs_score.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Gene set scoring — gs_score","text":"Tirosh2016 10.1126/science.aad0501","code":""},{"path":"/reference/gs_scores_in_clusters.html","id":null,"dir":"Reference","previous_headings":"","what":"Gene set scoring at cluster level — gs_scores_in_clusters","title":"Gene set scoring at cluster level — gs_scores_in_clusters","text":"Gene set scoring clusters","code":""},{"path":"/reference/gs_scores_in_clusters.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Gene set scoring at cluster level — gs_scores_in_clusters","text":"","code":"gs_scores_in_clusters(   score_table = NULL,   cell_clusters = NULL,   ncells_min = 5,   alt = \"g\",   test = \"t\",   null_model = TRUE )"},{"path":"/reference/gs_scores_in_clusters.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Gene set scoring at cluster level — gs_scores_in_clusters","text":"score_table real data cell_clusters vector cell clusters ncells_min minimum number cells required calculation average signature cluster alt alterative passed [wilcox.test()] [t.test()] test type test: t use [t.test()]; wrs use [wilcox.test()] null_model TRUE consider empirical null based gene set permutations","code":""},{"path":"/reference/gsea.html","id":null,"dir":"Reference","previous_headings":"","what":"Gene Set Enrichment Analysis — gsea","title":"Gene Set Enrichment Analysis — gsea","text":"Gene Set Enrichment Analysis","code":""},{"path":"/reference/gsea.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Gene Set Enrichment Analysis — gsea","text":"","code":"gsea(   rl,   gsl,   k = 100,   min.size = 100,   ord.mode = -1,   min.k.nes = 10,   mc_cores_path = 1,   mc_cores_perm = 1 )"},{"path":"/reference/gsea.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Gene Set Enrichment Analysis — gsea","text":"rl numeric matrix genes--ranking criteria; column contains numeric values; rownames mandatory gsl named list gene sets k number permutations ord.mode ordering mode: -1 -> descending; 1 ascending; must length equal `ncol(rl)` mc_cores_path number cores use parallel calculation gene set lists; total number cpu used mc_cores_path x mc_cores_perm mc_cores_perm number cores use parallel calculation ranked list permutations; total number cpu used mc_cores_path x mc_cores_perm","code":""},{"path":"/reference/gsea.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Gene Set Enrichment Analysis — gsea","text":"list two data.frames, gs_table leading_edge. gs_table contains: es, enrichment score; nes normalized enrichment score; p-value, empirical p-value; adjusted p-value, BH FDR; FDR q-value, empirical FDR. leading_edge contains: tags, leading edge size; tags_perc, leading edge size percent gene set; list_top, rank ES; list_top_perc, rank ES percent full ranked list; lead_edge, gene names leading edge.","code":""},{"path":"/reference/gsls_EntrezID.html","id":null,"dir":"Reference","previous_headings":"","what":"Gene set lists (Entrez Gene ID)\nGene set lists collected from the following sources:\n- CancerSEA: http://biocc.hrbmu.edu.cn/CancerSEA/goDownload\n- CM_cancer: http://bio-bigdata.hrbmu.edu.cn/CellMarker\n- CM_normal: http://bio-bigdata.hrbmu.edu.cn/CellMarker\n- PNDB: https://panglaodb.se\n- Tirosh2016: 10.1126/science.aad0501\n- Ribosomal proteins: — gsls_EntrezID","title":"Gene set lists (Entrez Gene ID)\nGene set lists collected from the following sources:\n- CancerSEA: http://biocc.hrbmu.edu.cn/CancerSEA/goDownload\n- CM_cancer: http://bio-bigdata.hrbmu.edu.cn/CellMarker\n- CM_normal: http://bio-bigdata.hrbmu.edu.cn/CellMarker\n- PNDB: https://panglaodb.se\n- Tirosh2016: 10.1126/science.aad0501\n- Ribosomal proteins: — gsls_EntrezID","text":"Gene set lists (Entrez Gene ID) Gene set lists collected following sources: - CancerSEA: http://biocc.hrbmu.edu.cn/CancerSEA/goDownload - CM_cancer: http://bio-bigdata.hrbmu.edu.cn/CellMarker - CM_normal: http://bio-bigdata.hrbmu.edu.cn/CellMarker - PNDB: https://panglaodb.se - Tirosh2016: 10.1126/science.aad0501 - Ribosomal proteins:","code":""},{"path":"/reference/gsls_EntrezID.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Gene set lists (Entrez Gene ID)\nGene set lists collected from the following sources:\n- CancerSEA: http://biocc.hrbmu.edu.cn/CancerSEA/goDownload\n- CM_cancer: http://bio-bigdata.hrbmu.edu.cn/CellMarker\n- CM_normal: http://bio-bigdata.hrbmu.edu.cn/CellMarker\n- PNDB: https://panglaodb.se\n- Tirosh2016: 10.1126/science.aad0501\n- Ribosomal proteins: — gsls_EntrezID","text":"","code":"gsls_EntrezID"},{"path":"/reference/gsls_EntrezID.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Gene set lists (Entrez Gene ID)\nGene set lists collected from the following sources:\n- CancerSEA: http://biocc.hrbmu.edu.cn/CancerSEA/goDownload\n- CM_cancer: http://bio-bigdata.hrbmu.edu.cn/CellMarker\n- CM_normal: http://bio-bigdata.hrbmu.edu.cn/CellMarker\n- PNDB: https://panglaodb.se\n- Tirosh2016: 10.1126/science.aad0501\n- Ribosomal proteins: — gsls_EntrezID","text":"object class list length 6.","code":""},{"path":"/reference/gsls_Symbol.html","id":null,"dir":"Reference","previous_headings":"","what":"Gene set lists (Symbol)\nGene set lists collected from the following sources:\n- CancerSEA: http://biocc.hrbmu.edu.cn/CancerSEA/goDownload\n- CM_cancer: http://bio-bigdata.hrbmu.edu.cn/CellMarker\n- CM_normal: http://bio-bigdata.hrbmu.edu.cn/CellMarker\n- PNDB: https://panglaodb.se\n- Tirosh2016: 10.1126/science.aad0501\n- Ribosomal proteins: — gsls_Symbol","title":"Gene set lists (Symbol)\nGene set lists collected from the following sources:\n- CancerSEA: http://biocc.hrbmu.edu.cn/CancerSEA/goDownload\n- CM_cancer: http://bio-bigdata.hrbmu.edu.cn/CellMarker\n- CM_normal: http://bio-bigdata.hrbmu.edu.cn/CellMarker\n- PNDB: https://panglaodb.se\n- Tirosh2016: 10.1126/science.aad0501\n- Ribosomal proteins: — gsls_Symbol","text":"Gene set lists (Symbol) Gene set lists collected following sources: - CancerSEA: http://biocc.hrbmu.edu.cn/CancerSEA/goDownload - CM_cancer: http://bio-bigdata.hrbmu.edu.cn/CellMarker - CM_normal: http://bio-bigdata.hrbmu.edu.cn/CellMarker - PNDB: https://panglaodb.se - Tirosh2016: 10.1126/science.aad0501 - Ribosomal proteins:","code":""},{"path":"/reference/gsls_Symbol.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Gene set lists (Symbol)\nGene set lists collected from the following sources:\n- CancerSEA: http://biocc.hrbmu.edu.cn/CancerSEA/goDownload\n- CM_cancer: http://bio-bigdata.hrbmu.edu.cn/CellMarker\n- CM_normal: http://bio-bigdata.hrbmu.edu.cn/CellMarker\n- PNDB: https://panglaodb.se\n- Tirosh2016: 10.1126/science.aad0501\n- Ribosomal proteins: — gsls_Symbol","text":"","code":"gsls_Symbol"},{"path":"/reference/gsls_Symbol.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Gene set lists (Symbol)\nGene set lists collected from the following sources:\n- CancerSEA: http://biocc.hrbmu.edu.cn/CancerSEA/goDownload\n- CM_cancer: http://bio-bigdata.hrbmu.edu.cn/CellMarker\n- CM_normal: http://bio-bigdata.hrbmu.edu.cn/CellMarker\n- PNDB: https://panglaodb.se\n- Tirosh2016: 10.1126/science.aad0501\n- Ribosomal proteins: — gsls_Symbol","text":"object class list length 6.","code":""},{"path":"/reference/heatmap_CNV.html","id":null,"dir":"Reference","previous_headings":"","what":"CNV Heatmap — heatmap_CNV","title":"CNV Heatmap — heatmap_CNV","text":"CNV Heatmap","code":""},{"path":"/reference/heatmap_CNV.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"CNV Heatmap — heatmap_CNV","text":"","code":"heatmap_CNV(   scMuffinList = NULL,   genes = NULL,   genes.labels = FALSE,   mark.detected.cnv = FALSE,   file = NULL,   width = 180,   height = 180,   units = \"mm\",   res = 300,   image_format = \"png\",   cluster_fontsize = 8,   chrom_fontsize = 8,   legend_fontsize = 8,   genes.labels.fontsize = 8,   ... )"},{"path":"/reference/heatmap_CNV.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"CNV Heatmap — heatmap_CNV","text":"scMuffinList scMuffinList object genes gene labels show row annotation genes.labels whether show gene labels just mark position mark.detected.cnv whether show detected CNV regions file output file width image width height image height units image units res image resolution image_format png jpeg cluster_fontsize cluster fontsize chrom_fontsize chromosome fontsize legend_fontsize legend fontsize genes.labels.fontsize gene labels fontsize ... arguments passed ComplexHeatmap::Heatmap","code":""},{"path":"/reference/inter_dataset_comparison.html","id":null,"dir":"Reference","previous_headings":"","what":"Inter-dataset cluster similarity — inter_dataset_comparison","title":"Inter-dataset cluster similarity — inter_dataset_comparison","text":"Quantify similarity clusters two datasets, basis average cluster marker expression","code":""},{"path":"/reference/inter_dataset_comparison.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Inter-dataset cluster similarity — inter_dataset_comparison","text":"","code":"inter_dataset_comparison(   seu_obj_list = NULL,   gsl = NULL,   genes_min = 3,   genes_max = 500,   mc.cores = 1,   null_model = TRUE,   ncells_min = 5,   cluster_rows = FALSE,   cluster_columns = FALSE,   ... )"},{"path":"/reference/inter_dataset_comparison.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Inter-dataset cluster similarity — inter_dataset_comparison","text":"seu_obj_list list Seurat objects gsl gene set list genes_min minimum number genes required among markers cluster genes_max maximum number genes required among markers cluster mc.cores number cores null_model whether use empirical null model. See calculate_signature ncells_min minim number cells cluster cluster_rows whether cluster rows cluster_columns whether cluster columns ... arguments passed calculate_signatures","code":""},{"path":"/reference/inter_dataset_comparison.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Inter-dataset cluster similarity — inter_dataset_comparison","text":"list : clust_sim, matrix clucster similarity; m1=m1 m2=m2 markers_1, markers dataset 1; markers_2, markers dataset 2;","code":""},{"path":"/reference/inter_ds_cluster_sim.html","id":null,"dir":"Reference","previous_headings":"","what":"Inter-dataset cluster similarity — inter_ds_cluster_sim","title":"Inter-dataset cluster similarity — inter_ds_cluster_sim","text":"Quantify similarity clusters two datasets, basis average cluster marker expression","code":""},{"path":"/reference/inter_ds_cluster_sim.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Inter-dataset cluster similarity — inter_ds_cluster_sim","text":"","code":"inter_ds_cluster_sim(   gbc_1,   gbc_2,   clusters_1,   clusters_2,   cluster_markers_1,   cluster_markers_2,   genes_min = 3,   genes_max = 500,   mc.cores = 1,   null_model = TRUE,   ncells_min = 5,   do_plot = TRUE,   dataset_name_1 = \"S1\",   dataset_name_2 = \"S2\",   outfile = \"cluster_similarity.jpg\",   pal = NULL,   cluster_rows = FALSE,   cluster_columns = FALSE,   top_genes = FALSE,   ... )"},{"path":"/reference/inter_ds_cluster_sim.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Inter-dataset cluster similarity — inter_ds_cluster_sim","text":"gbc_1 genes--cells expression matrix dataset 1 gbc_2 genes--cells expression matrix dataset 2 clusters_1 named vector cell clustering fo dataset 1 clusters_2 named vector cell clustering fo dataset 2 cluster_markers_1 list markers cluster dataset 1 cluster_markers_2 list markers cluster dataset 2 genes_min minimum number genes required among markers cluster genes_max maximum number genes required among markers cluster mc.cores number cores null_model whether use empirical null model. See calculate_signature ncells_min minim number cells cluster do_plot whether plot results dataset_name_1 dataset 1 name dataset_name_2 dataset 2 name outfile file name pal palette output heatmap cluster_rows whether cluster rows cluster_columns whether cluster columns top_genes specified, first top_genes genes every element lists cluster_markers_1 cluster_markers_2 considered. implies markers clusters considered sorted decreasing relevance. Default FALSE, ... arguments passed calculate_signatures","code":""},{"path":"/reference/inter_ds_cluster_sim.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Inter-dataset cluster similarity — inter_ds_cluster_sim","text":"list : clust_sim, matrix clucster similarity; m1=m1 m2=m2 markers_1, markers dataset 1; markers_2, markers dataset 2;","code":""},{"path":"/reference/keep_strongest_representative.html","id":null,"dir":"Reference","previous_headings":"","what":"Keep the feature with the average highest values — keep_strongest_representative","title":"Keep the feature with the average highest values — keep_strongest_representative","text":"Keep feature average highest values","code":""},{"path":"/reference/keep_strongest_representative.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Keep the feature with the average highest values — keep_strongest_representative","text":"","code":"keep_strongest_representative(genes_by_cells = NULL, row.names = NULL)"},{"path":"/reference/keep_strongest_representative.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Keep the feature with the average highest values — keep_strongest_representative","text":"genes_by_cells genes--cells expression matrix row.names row.names assigned","code":""},{"path":"/reference/meta_cluster.html","id":null,"dir":"Reference","previous_headings":"","what":"Analysis of the various partitions and definition of meta-clusters — meta_cluster","title":"Analysis of the various partitions and definition of meta-clusters — meta_cluster","text":"Calculate overlap matrix -pars clusters existing partitions.","code":""},{"path":"/reference/meta_cluster.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Analysis of the various partitions and definition of meta-clusters — meta_cluster","text":"","code":"meta_cluster(scMuffinList = NULL, n_step = 11, max_clust = 10, do_plot = FALSE)"},{"path":"/reference/meta_cluster.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Analysis of the various partitions and definition of meta-clusters — meta_cluster","text":"scMuffinList scMuffinList object least two partitions n_step number used divide hclust dendrogram height obtain cut values calculate silhouette max_clust maximum number clusters do_plot whether silohouette plot ","code":""},{"path":"/reference/meta_cluster.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Analysis of the various partitions and definition of meta-clusters — meta_cluster","text":"scMuffinList : scMuffinList$cluster_comparison$overlap_matrix, overlap matrix scMuffinList$cluster_comparison$meta_clusters, list information meta-clusters: dissimilarity, dissimilarity matrix; hclust_out, stats::hclust output; clusters, data.frame mapping  clusters meta-clusters; cells, data.frame mapping cells meta-clusters; occurrence, list meta-clusters, element data.frame show occurrence meta-cluster cells across clusters.","code":""},{"path":"/reference/ora.html","id":null,"dir":"Reference","previous_headings":"","what":"Over Representation Analysis — ora","title":"Over Representation Analysis — ora","text":"representation analysis","code":""},{"path":"/reference/ora.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Over Representation Analysis — ora","text":"","code":"ora(wb, bb, gsl, p_adj_method = \"fdr\")"},{"path":"/reference/ora.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Over Representation Analysis — ora","text":"wb hits (white balls) bb elements (black balls) gsl named list sets p_adj_method p value adjustment method, see p.adjust.methods","code":""},{"path":"/reference/ora1gs.html","id":null,"dir":"Reference","previous_headings":"","what":"Hypergeometric test on 1 feature set — ora1gs","title":"Hypergeometric test on 1 feature set — ora1gs","text":"Hypergeometric test 1 feature set","code":""},{"path":"/reference/ora1gs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Hypergeometric test on 1 feature set — ora1gs","text":"","code":"ora1gs(wb, bb, bd)"},{"path":"/reference/ora1gs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Hypergeometric test on 1 feature set — ora1gs","text":"wb white balls bb black balls bd balls drawn","code":""},{"path":"/reference/overlap_coefficient.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate the overlap coefficient between two sets — overlap_coefficient","title":"Calculate the overlap coefficient between two sets — overlap_coefficient","text":"Calculate overlap coefficient two sets","code":""},{"path":"/reference/overlap_coefficient.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate the overlap coefficient between two sets — overlap_coefficient","text":"","code":"overlap_coefficient(x, y)"},{"path":"/reference/overlap_coefficient.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate the overlap coefficient between two sets — overlap_coefficient","text":"x vector items y vector items","code":""},{"path":"/reference/overlap_coefficient.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate the overlap coefficient between two sets — overlap_coefficient","text":"overlap coefficient","code":""},{"path":"/reference/overlap_matrix.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate the overlap matrix between clusters — overlap_matrix","title":"Calculate the overlap matrix between clusters — overlap_matrix","text":"Calculate overlap coefficient n sets","code":""},{"path":"/reference/overlap_matrix.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate the overlap matrix between clusters — overlap_matrix","text":"","code":"overlap_matrix(scMuffinList = NULL)"},{"path":"/reference/overlap_matrix.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate the overlap matrix between clusters — overlap_matrix","text":"scMuffinList scMuffinList object","code":""},{"path":"/reference/overlap_matrix.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate the overlap matrix between clusters — overlap_matrix","text":"scMuffinList scMuffinList$cluster_comparison$overlap_matrix","code":""},{"path":"/reference/partitions_to_list.html","id":null,"dir":"Reference","previous_headings":"","what":"Transform partitions to lists — partitions_to_list","title":"Transform partitions to lists — partitions_to_list","text":"Clusterings list","code":""},{"path":"/reference/partitions_to_list.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Transform partitions to lists — partitions_to_list","text":"","code":"partitions_to_list(partitions)"},{"path":"/reference/partitions_to_list.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Transform partitions to lists — partitions_to_list","text":"partitions partitions object","code":""},{"path":"/reference/partitions_to_list.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Transform partitions to lists — partitions_to_list","text":"List partitions","code":""},{"path":"/reference/plot_heatmap_dataset_comparison.html","id":null,"dir":"Reference","previous_headings":"","what":"plot_heatmap_dataset_comparison — plot_heatmap_dataset_comparison","title":"plot_heatmap_dataset_comparison — plot_heatmap_dataset_comparison","text":"plot_heatmap_dataset_comparison","code":""},{"path":"/reference/plot_heatmap_dataset_comparison.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"plot_heatmap_dataset_comparison — plot_heatmap_dataset_comparison","text":"","code":"plot_heatmap_dataset_comparison(   dataset_cmp_list = NULL,   type = \"score\",   show.gs.source = FALSE,   outfile = NULL,   width = 200,   height = 200,   units = \"mm\",   res = 300,   ... )"},{"path":"/reference/plot_heatmap_dataset_comparison.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"plot_heatmap_dataset_comparison — plot_heatmap_dataset_comparison","text":"dataset_cmp_list list resulting inter_dataset_comparison() type \"score\" \"significance\" , respectively, cluster median marker set score -log10(FDRq) CSEA. show.gs.source whether show gene set source outfile file name width image width height image height units image units res image res ... arguments passed ComplexHeatmap::Heatmap","code":""},{"path":"/reference/plot_heatmap_features_by_clusters.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot an heatmap of feature values in cell clusters — plot_heatmap_features_by_clusters","title":"Plot an heatmap of feature values in cell clusters — plot_heatmap_features_by_clusters","text":"Plot heatmap feature values cell clusters","code":""},{"path":"/reference/plot_heatmap_features_by_clusters.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot an heatmap of feature values in cell clusters — plot_heatmap_features_by_clusters","text":"","code":"plot_heatmap_features_by_clusters(   scMuffinList = NULL,   feature_source = NULL,   partition_id = NULL,   significance_matrix = NULL,   sig_threshold = 0.05,   file = NULL,   width = 180,   height = 180,   units = \"mm\",   res = 300,   scale = TRUE,   pal = NULL,   ... )"},{"path":"/reference/plot_heatmap_features_by_clusters.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot an heatmap of feature values in cell clusters — plot_heatmap_features_by_clusters","text":"scMuffinList scMuffinList object feature_source can \"mean\", \"gss\" numeric matrix (clusters--features). \"mean\", data.frame average feature values among clusters used (default); \"gene_set_scoring\", average gene set values among clusters used. partition_id identifier partition considered significance_matrix optional significance matrix (clusters--features) size data specified means feature_source sig_threshold significance threshold file output file width image width height image height units image units res image resolution scale whether scale features pal color palette. Default rev(pals::brewer.rdylbu(10)) (negative values) pals::brewer.ylorrd(5)) (positive values) ... arguments ComplexHeatmap::Heatmap","code":""},{"path":"/reference/plot_meta_clusters.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot meta clusters — plot_meta_clusters","title":"Plot meta clusters — plot_meta_clusters","text":"Plot meta clusters","code":""},{"path":"/reference/plot_meta_clusters.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot meta clusters — plot_meta_clusters","text":"","code":"plot_meta_clusters(   ov_mat = NULL,   meta_clusters = NULL,   out_file = \"meta_clusters.jpg\",   ... )"},{"path":"/reference/plot_meta_clusters.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot meta clusters — plot_meta_clusters","text":"ov_mat overlap matrix meta_clusters meta clusters out_file output file ... arguments ComplexHeatmap::Heatmap","code":""},{"path":"/reference/plot_profile_CNV.html","id":null,"dir":"Reference","previous_headings":"","what":"CNV Profile — plot_profile_CNV","title":"CNV Profile — plot_profile_CNV","text":"Plot heatmap CNV.","code":""},{"path":"/reference/plot_profile_CNV.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"CNV Profile — plot_profile_CNV","text":"","code":"plot_profile_CNV(   scMuffinList = NULL,   cluster = 0,   z.score = TRUE,   file = NULL,   width = 300,   height = 90,   units = \"mm\",   res = 300,   image_format = \"png\",   cex.points = 0.7,   cex.lab = 0.7,   cex.axis = 0.7,   cex.main = 0.7 )"},{"path":"/reference/plot_profile_CNV.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"CNV Profile — plot_profile_CNV","text":"scMuffinList scMuffinList object cluster cluster plotted z.score whether plot clustere median z-scores CNV signal (TRUE) cluster median CNV signal (FALSE). file output file width image width height image height units image units res image resolution image_format png jpeg cex.points cex points cex.lab cex labs cex.axis cex axis cex.main cex main","code":""},{"path":"/reference/plot_profile_CNV.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"CNV Profile — plot_profile_CNV","text":"CNV Profile every cluster","code":""},{"path":"/reference/plot_umap.html","id":null,"dir":"Reference","previous_headings":"","what":"plot_umap — plot_umap","title":"plot_umap — plot_umap","text":"Generate UMAP visualization","code":""},{"path":"/reference/plot_umap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"plot_umap — plot_umap","text":"","code":"plot_umap(   Seu_obj,   file = \"umap.jpg\",   labels = NULL,   group.by = NULL,   feature_plot = FALSE,   lab_size = 1,   lab_color = \"black\",   adj_outliers = FALSE,   width = 180,   height = 180,   units = \"mm\",   res = 300,   image_format = \"png\",   text.size = 5,   ... )"},{"path":"/reference/plot_umap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"plot_umap — plot_umap","text":"Seu_obj seurat object, object saved dimension reduction components file string, file name output labels cluster labels group.feature colour (e.g. cluster ID) feature_plot whether call Seurat::FeaturePlot lab_size label size lab_color label color adj_outliers logical, whether adjust group.scores, removing outliers width image width height image height units image units res image resolution image_format png jpeg text.size text size ... arguments Seurat::FeaturePlot Seurat::DimPlot","code":""},{"path":"/reference/plot_umap.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"plot_umap — plot_umap","text":"Generate UMAP visualization","code":""},{"path":"/reference/plot_umap_colored_features.html","id":null,"dir":"Reference","previous_headings":"","what":"UMAP Visualization colored by features — plot_umap_colored_features","title":"UMAP Visualization colored by features — plot_umap_colored_features","text":"Generate UMAP visualizations columns \"summary\" element feature available scMuffinList. requires Seurat object UMAP information.","code":""},{"path":"/reference/plot_umap_colored_features.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"UMAP Visualization colored by features — plot_umap_colored_features","text":"","code":"plot_umap_colored_features(   Seu_obj = NULL,   scMuffinList = NULL,   feature_name = NULL,   scale_feature = TRUE,   adj_outliers = FALSE,   min_cells = 10,   out_dir = \"./\",   width = 180,   height = 180,   units = \"mm\",   res = 300,   image_format = \"png\",   ... )"},{"path":"/reference/plot_umap_colored_features.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"UMAP Visualization colored by features — plot_umap_colored_features","text":"Seu_obj Seurat object UMAP data scMuffinList scMuffinList object feature_name feature name scale_feature whether scale feature values adj_outliers logical, whether adjust feature scores, removing outliers min_cells minimum number cells feature must non-zero value out_dir output directory width image width height image height units image units res image resolution image_format png jpeg ... arguments plot_umap","code":""},{"path":"/reference/prepare_cluster_markers_list.html","id":null,"dir":"Reference","previous_headings":"","what":"Prepare cluster markers list\nPrepare cluster markers list for inter_dataset_comparison — prepare_cluster_markers_list","title":"Prepare cluster markers list\nPrepare cluster markers list for inter_dataset_comparison — prepare_cluster_markers_list","text":"Prepare cluster markers list Prepare cluster markers list inter_dataset_comparison","code":""},{"path":"/reference/prepare_cluster_markers_list.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prepare cluster markers list\nPrepare cluster markers list for inter_dataset_comparison — prepare_cluster_markers_list","text":"","code":"prepare_cluster_markers_list(   marker_table_list = NULL,   effect_size = \"avg_logFC\",   effect_size_thr = 0.25,   sig_column = \"p_val_adj\",   sig_thr = 0.1,   id_column = 0,   cluster = \"cluster\",   top = 500 )"},{"path":"/reference/prepare_cluster_markers_list.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Prepare cluster markers list\nPrepare cluster markers list for inter_dataset_comparison — prepare_cluster_markers_list","text":"marker_table_list list marker tables, produced Seurat::FindAllMarkers effect_size name effect size column effect_size_thr threshold effect size sig_column column significance score sig_thr threshold effect significance score id_column column IDs cluster column cell cluster top maximum number markers per cluster","code":""},{"path":"/reference/prepare_gsls.html","id":null,"dir":"Reference","previous_headings":"","what":"Prepare the gene set lists collected from various sources — prepare_gsls","title":"Prepare the gene set lists collected from various sources — prepare_gsls","text":"Prepare gene set lists collected various sources","code":""},{"path":"/reference/prepare_gsls.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prepare the gene set lists collected from various sources — prepare_gsls","text":"","code":"prepare_gsls(   gs_sources = NULL,   custom_gsls = NULL,   CM_tissues = NULL,   PNDB_tissues = NULL,   msigdb_hs_cat_subcat = NULL,   genes_min = 5,   genes_max = 500,   id_type = c(\"Symbol\", \"EntrezID\"),   scMuffinList = NULL,   genes = NULL )"},{"path":"/reference/prepare_gsls.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Prepare the gene set lists collected from various sources — prepare_gsls","text":"gs_sources character vector, possible values: \"CM_cancer\", \"CM_normal\", \"CancerSEA\", \"PNDB\" \"msigdb\" custom_gsls named list gene sets CM_tissues character vector strings filter CellMArker db tissue name PNDB_tissues character vector strings filter Panglao db tissue name msigdb_hs_cat_subcat data.frame species, category subcategory: e.g. \"Homo sapiens\", \"NA\", \"CP:KEGG\" genes_min minimum number genes required gene set genes_max maximum number genes required gene set id_type type id: Symbol EntrezID scMuffinList scMuffinList object genes genes considered","code":""},{"path":"/reference/prepare_gsls.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Prepare the gene set lists collected from various sources — prepare_gsls","text":"lists gene set lists","code":""},{"path":"/reference/preprocess_for_heatmap_CNV.html","id":null,"dir":"Reference","previous_headings":"","what":"preprocess_for_heatmap_CNV — preprocess_for_heatmap_CNV","title":"preprocess_for_heatmap_CNV — preprocess_for_heatmap_CNV","text":"Bind chromosomes together matrix.","code":""},{"path":"/reference/preprocess_for_heatmap_CNV.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"preprocess_for_heatmap_CNV — preprocess_for_heatmap_CNV","text":"","code":"preprocess_for_heatmap_CNV(result_cnv)"},{"path":"/reference/preprocess_for_heatmap_CNV.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"preprocess_for_heatmap_CNV — preprocess_for_heatmap_CNV","text":"result_cnv object resulting CNV analyiss","code":""},{"path":"/reference/preprocess_for_heatmap_CNV.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"preprocess_for_heatmap_CNV — preprocess_for_heatmap_CNV","text":"matrix used function heatmap_CNV.","code":""},{"path":"/reference/preprocess_for_heatmap_CNV.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"preprocess_for_heatmap_CNV — preprocess_for_heatmap_CNV","text":"Valentina Nale","code":""},{"path":"/reference/preprocess_object_for_CNV.html","id":null,"dir":"Reference","previous_headings":"","what":"preprocess_object_for_CNV — preprocess_object_for_CNV","title":"preprocess_object_for_CNV — preprocess_object_for_CNV","text":"Preprocessing function obtain genomically-ordered list chromosomes.","code":""},{"path":"/reference/preprocess_object_for_CNV.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"preprocess_object_for_CNV — preprocess_object_for_CNV","text":"","code":"preprocess_object_for_CNV(genes_by_cells)"},{"path":"/reference/preprocess_object_for_CNV.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"preprocess_object_for_CNV — preprocess_object_for_CNV","text":"genes_by_cells genes--cells input matrix","code":""},{"path":"/reference/preprocess_object_for_CNV.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"preprocess_object_for_CNV — preprocess_object_for_CNV","text":"list genomically-ordered chromosomes","code":""},{"path":"/reference/preprocess_object_for_CNV.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"preprocess_object_for_CNV — preprocess_object_for_CNV","text":"preliminary step consist annotation, duplicates NA values removal.  , matrix splitted list dataframe, every dataframe chromosome. Chromosomes ordered 1 22 + X +Y, re-ordered start position.","code":""},{"path":"/reference/preprocess_object_for_CNV.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"preprocess_object_for_CNV — preprocess_object_for_CNV","text":"Valentina Nale","code":""},{"path":"/reference/process_GTEx_gene_reads.html","id":null,"dir":"Reference","previous_headings":"","what":"Process GTEx expression data — process_GTEx_gene_reads","title":"Process GTEx expression data — process_GTEx_gene_reads","text":"GTEx gene reads file processed obtain average normalized gene expression tissue","code":""},{"path":"/reference/process_GTEx_gene_reads.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Process GTEx expression data — process_GTEx_gene_reads","text":"","code":"process_GTEx_gene_reads(   geneReads = NULL,   GTEx_annot = NULL,   tissue = NULL,   id_type = c(\"gene_id\", \"symbol\"),   nrows = -1,   norm.type = \"LogNormalize\",   ... )"},{"path":"/reference/process_GTEx_gene_reads.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Process GTEx expression data — process_GTEx_gene_reads","text":"geneReads GTEx gene reads \"gct\" file, e.g. \"GTEx_Analysis_2017-06-05_v8_RNASeQCv1.1.9_gene_reads.gct\" GTEx_annot GTEx Sample annotation file, e.g. \"GTEx_Analysis_v8_Annotations_SampleAttributesDS.txt\" tissue tissue name, see param \"SMTS\" annotation id_type whether output specified gene_id symbol nrows limit read top nrows. Useful testing. norm.type Method normalization. See Seurat::NormalizeData. ... arguments passed functin Seurat::NormalizeData.","code":""},{"path":"/reference/process_GTEx_gene_reads.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Process GTEx expression data — process_GTEx_gene_reads","text":"average normalized gene expression values","code":""},{"path":"/reference/proliferation_analysis.html","id":null,"dir":"Reference","previous_headings":"","what":"Define a proliferation score — proliferation_analysis","title":"Define a proliferation score — proliferation_analysis","text":"Define proliferation score basis two cell cycle gene sets. See SIG_Tirosh","code":""},{"path":"/reference/proliferation_analysis.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Define a proliferation score — proliferation_analysis","text":"","code":"proliferation_analysis(   scMuffinList = NULL,   mc.cores = 1,   nbins = 25,   nmark_min = 5,   ncells_min = 5,   k = 99,   kmin = 49,   score_type = c(\"relative\", \"mean\"),   null_model = TRUE,   mean_scale = TRUE,   gsl = NULL )"},{"path":"/reference/proliferation_analysis.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Define a proliferation score — proliferation_analysis","text":"scMuffinList scMuffinList object mc.cores number cores nbins number bins split distribution average gene expression nmark_min numner minimum markers required succesful calculation signature ncells_min numner minimum cells gene set succesfully calculated k number permutations kmin minimum number permutations; due missing values hard ensure signature can compared k permutations every cell score_type type score. \"relative\", score difference observed gene set average expression k permutations; \"mean\" score equal observed gene set average expression null_model TRUE permutations used. Required score_type=\"relative\" mean_scale whether scale values obtained using score_type=\"mean\" gsl gene set list cell cycle genes","code":""},{"path":"/reference/proliferation_analysis.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Define a proliferation score — proliferation_analysis","text":"scMuffinList element \"proliferation\", list : summary: data.frame proliferation value full: data.frame vales two considered gene sets","code":""},{"path":"/reference/regions_to_genes.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a map between CNV regions and genes — regions_to_genes","title":"Create a map between CNV regions and genes — regions_to_genes","text":"Create map CNV regions genes","code":""},{"path":"/reference/regions_to_genes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a map between CNV regions and genes — regions_to_genes","text":"","code":"regions_to_genes(CNV = NULL, CNV_input = NULL)"},{"path":"/reference/regions_to_genes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a map between CNV regions and genes — regions_to_genes","text":"CNV CNV matrix CNV_input CNV_input","code":""},{"path":"/reference/scMuffinList_demo.html","id":null,"dir":"Reference","previous_headings":"","what":"scMuffinList_demo\nscMuffinList object with a partial dataset used in vignettes. — scMuffinList_demo","title":"scMuffinList_demo\nscMuffinList object with a partial dataset used in vignettes. — scMuffinList_demo","text":"scMuffinList_demo scMuffinList object partial dataset used vignettes.","code":""},{"path":"/reference/scMuffinList_demo.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"scMuffinList_demo\nscMuffinList object with a partial dataset used in vignettes. — scMuffinList_demo","text":"","code":"scMuffinList_demo"},{"path":"/reference/scMuffinList_demo.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"scMuffinList_demo\nscMuffinList object with a partial dataset used in vignettes. — scMuffinList_demo","text":"object class list length 10.","code":""},{"path":"/reference/sc_create_null.html","id":null,"dir":"Reference","previous_headings":"","what":"Create empirical null for gene set scoring — sc_create_null","title":"Create empirical null for gene set scoring — sc_create_null","text":"sc_create_null","code":""},{"path":"/reference/sc_create_null.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create empirical null for gene set scoring — sc_create_null","text":"","code":"sc_create_null(genes_by_cells = NULL, bins = NULL, gene_set = NULL, k = 100)"},{"path":"/reference/sc_create_null.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create empirical null for gene set scoring — sc_create_null","text":"genes_by_cells genes--cells matrix bins bins genes, created means sc_data_bin gene_set vector genes k number permutations","code":""},{"path":"/reference/sc_create_null.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create empirical null for gene set scoring — sc_create_null","text":"list null gene sets.","code":""},{"path":"/reference/sc_create_null.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Create empirical null for gene set scoring — sc_create_null","text":"Ettore Mosca","code":""},{"path":"/reference/sc_data_bin.html","id":null,"dir":"Reference","previous_headings":"","what":"Split the genes into bins by their expression — sc_data_bin","title":"Split the genes into bins by their expression — sc_data_bin","text":"Split input data matrix rows nbins","code":""},{"path":"/reference/sc_data_bin.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Split the genes into bins by their expression — sc_data_bin","text":"","code":"sc_data_bin(genes_by_cells = NULL, nbins = 25, na.rm = FALSE)"},{"path":"/reference/sc_data_bin.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Split the genes into bins by their expression — sc_data_bin","text":"genes_by_cells genes--cells matrix nbins number bins na.rm TRUE, cells null (0) values considered calculation gene expression level.","code":""},{"path":"/reference/sc_data_bin.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Split the genes into bins by their expression — sc_data_bin","text":"vector bin identifier gene","code":""},{"path":"/reference/show_tissues.html","id":null,"dir":"Reference","previous_headings":"","what":"Show the tissues available for prepare_gsls — show_tissues","title":"Show the tissues available for prepare_gsls — show_tissues","text":"Show tissues available means prepare_gsls","code":""},{"path":"/reference/show_tissues.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Show the tissues available for prepare_gsls — show_tissues","text":"","code":"show_tissues(gsc_source = c(\"PNDB\", \"CM_normal\", \"CM_cancer\"))"},{"path":"/reference/show_tissues.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Show the tissues available for prepare_gsls — show_tissues","text":"gsc_source source database","code":""},{"path":"/reference/show_tissues.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Show the tissues available for prepare_gsls — show_tissues","text":"List gsc_source tissue vectors.","code":""},{"path":"/reference/transcr_compl.html","id":null,"dir":"Reference","previous_headings":"","what":"Transcriptional Complexity and Entropy — transcr_compl","title":"Transcriptional Complexity and Entropy — transcr_compl","text":"Transcriptional Complexity Entropy","code":""},{"path":"/reference/transcr_compl.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Transcriptional Complexity and Entropy — transcr_compl","text":"","code":"transcr_compl(   scMuffinList = NULL,   min_counts = 5,   min_cells = 10,   min_genes = 500 )"},{"path":"/reference/transcr_compl.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Transcriptional Complexity and Entropy — transcr_compl","text":"scMuffinList scMuffinList object min_counts minimum number counts min_cells minimum number cells gene must least min_counts counts min_genes minimum number genes cell must express least min_counts counts","code":""},{"path":"/reference/transcr_compl.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Transcriptional Complexity and Entropy — transcr_compl","text":"scMuffinList transcr_compl element list summary (full empty): tot_counts, total number transcripts; n_genes, total number expressed genes; C, transcriptional complexity; H, transcriptional entropy;","code":""}]
