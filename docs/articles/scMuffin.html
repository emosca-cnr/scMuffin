<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="scMuffin">
<title>scMuffin package vignettes • scMuffin</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="scMuffin package vignettes">
<meta property="og:description" content="scMuffin">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">scMuffin</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.5</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/scMuffin.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>scMuffin package vignettes</h1>
            
      
      
      <div class="d-none name"><code>scMuffin.Rmd</code></div>
    </div>

    
    
<p><img src="images/logo.jpg" width="300"></p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>scMuffin requires R &gt;= 4.0.0, due to some of its dependencies,
like Seurat <span class="citation">(Hao et al. 2021)</span>. R can be
installed from CRAN at the URL <a href="https://cran.r-project.org/index.html" class="external-link uri">https://cran.r-project.org/index.html</a>.</p>
<p>To succesfully install scMuffin you need some packages from
Bioconductor (<a href="https://bioconductor.org" class="external-link uri">https://bioconductor.org</a>) and github (<a href="https://github.com/" class="external-link uri">https://github.com/</a>). These
packages can be installed using the following commands:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="https://bioconductor.github.io/BiocManager/" class="external-link">"BiocManager"</a></span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"BiocManager"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">BiocManager</span><span class="fu">::</span><span class="fu"><a href="https://bioconductor.github.io/BiocManager/reference/install.html" class="external-link">install</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BiocStyle"</span>, <span class="st">"ComplexHeatmap"</span>, <span class="st">"DESeq2"</span>, <span class="st">"org.Hs.eg.db"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="https://devtools.r-lib.org/" class="external-link">"devtools"</a></span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"theislab/destiny"</span><span class="op">)</span></span></code></pre></div>
<p>The other dependencies, if missing, should be automatically installed
using the following command:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"emosca-cnr/scMuffin"</span>, build_vignettes <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>To load the package:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">scMuffin</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="input">Input<a class="anchor" aria-label="anchor" href="#input"></a>
</h2>
<p>scMuffin is intended to be used downstream general purpose tasks like
quality control, normalization, cell clustering and dataset integration,
for which there are dedicated tools, such as Seurat <span class="citation">(Hao et al. 2021)</span>. scMuffin requires three
inputs:</p>
<ul>
<li>genes-by-cells raw counts matrix;</li>
<li>genes-by-cells normalized expression matrix;</li>
<li>a partition of cells (cell clusters).</li>
</ul>
<p>The rownames and colnames of the two matrices must be, respectively,
gene identifiers and cell identifiers. Currently, we recommend to use
official gene symbols. Some analysis, like CNV inference, works only
with gene symbols.</p>
<p>Typically, the two genes-by-cells matrices have already been filtered
to exclude low quality cells and genes that could negatively affect the
analyses. However, the characterization of cells that can be achieved
with scMuffin offers insights that can be used to (further) filter a
dataset and/or to decide on which cells apply particular analyses
(e.g. biomarker identification). In general, according to research
questions and experimental design strong or mild filters should be
applied before using scMuffin.</p>
</div>
<div class="section level2">
<h2 id="obtaining-the-data-used-in-this-vignette">Obtaining the data used in this vignette<a class="anchor" aria-label="anchor" href="#obtaining-the-data-used-in-this-vignette"></a>
</h2>
<p>Here’s an example of how to obtain a publicly available single cell
dataset from Gene Expression Omnibus (GEO). In particular, we will
consider a sample from a study on High-Grade Glioma <span class="citation">(J. Yuan et al. 2018)</span> (GSE103224):</p>
<ol style="list-style-type: decimal">
<li>download the filtered genes-by-cells mtrices from the URLs:</li>
</ol>
<ul>
<li>sample PJ016: <a href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM2758471" class="external-link uri">https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM2758471</a>;</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>read the text files into R and use the Seurat package <span class="citation">(Hao et al. 2021)</span> to perform a series of typical
tasks (e.g. normalization, clustering); here’s a concise example using
sample PJ016:</li>
</ol>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://satijalab.org/seurat" class="external-link">Seurat</a></span><span class="op">)</span></span>
<span><span class="va">gbc_counts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span><span class="st">"GSM2758471_PJ016.filtered.matrix.txt"</span>, stringsAsFactors <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="va">sym</span> <span class="op">&lt;-</span> <span class="va">gbc_counts</span><span class="op">[</span>, <span class="st">"V2"</span><span class="op">]</span></span>
<span><span class="va">gbc_counts</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"V1"</span>, <span class="st">"V2"</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="va">gbc_counts</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/keep_strongest_representative.html">keep_strongest_representative</a></span><span class="op">(</span>genes_by_cells <span class="op">=</span> <span class="va">gbc_counts</span>, <span class="va">sym</span><span class="op">)</span></span>
<span>    </span>
<span><span class="va">seu_obj_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mojaveazure.github.io/seurat-object/reference/CreateSeuratObject.html" class="external-link">CreateSeuratObject</a></span><span class="op">(</span>counts <span class="op">=</span> <span class="va">gbc_counts</span>, project <span class="op">=</span> <span class="st">"PJ016"</span>,</span>
<span>                                min.cells <span class="op">=</span> <span class="fl">100</span>, min.features <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span><span class="va">seu_obj_1</span><span class="op">[[</span><span class="st">"pMito"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://satijalab.org/seurat/reference/PercentageFeatureSet.html" class="external-link">PercentageFeatureSet</a></span><span class="op">(</span><span class="va">seu_obj_1</span>, pattern <span class="op">=</span> <span class="st">"^MT-"</span><span class="op">)</span></span>
<span><span class="va">seu_obj_1</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">seu_obj_1</span>,  subset <span class="op">=</span> <span class="va">nFeature_RNA</span> <span class="op">&gt;</span> <span class="fl">200</span> <span class="op">&amp;</span></span>
<span>                       <span class="va">nFeature_RNA</span> <span class="op">&lt;</span> <span class="fl">8000</span> <span class="op">&amp;</span> <span class="va">nCount_RNA</span> <span class="op">&lt;</span> <span class="fl">30000</span> <span class="op">&amp;</span> <span class="va">pMito</span> <span class="op">&lt;</span> <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="va">seu_obj_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://satijalab.org/seurat/reference/NormalizeData.html" class="external-link">NormalizeData</a></span><span class="op">(</span><span class="va">seu_obj_1</span><span class="op">)</span></span>
<span><span class="va">seu_obj_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://satijalab.org/seurat/reference/FindVariableFeatures.html" class="external-link">FindVariableFeatures</a></span><span class="op">(</span><span class="va">seu_obj_1</span>, selection.method <span class="op">=</span> <span class="st">"vst"</span>,</span>
<span>                                  nfeatures <span class="op">=</span> <span class="fl">2000</span><span class="op">)</span></span>
<span><span class="va">seu_obj_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://satijalab.org/seurat/reference/ScaleData.html" class="external-link">ScaleData</a></span><span class="op">(</span><span class="va">seu_obj_1</span>, features <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">seu_obj_1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">seu_obj_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://satijalab.org/seurat/reference/RunPCA.html" class="external-link">RunPCA</a></span><span class="op">(</span><span class="va">seu_obj_1</span>, npcs <span class="op">=</span> <span class="fl">10</span>,</span>
<span>                    features <span class="op">=</span> <span class="fu"><a href="https://mojaveazure.github.io/seurat-object/reference/VariableFeatures.html" class="external-link">VariableFeatures</a></span><span class="op">(</span><span class="va">seu_obj_1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">seu_obj_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://satijalab.org/seurat/reference/FindNeighbors.html" class="external-link">FindNeighbors</a></span><span class="op">(</span><span class="va">seu_obj_1</span>, dims <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">seu_obj_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://satijalab.org/seurat/reference/FindClusters.html" class="external-link">FindClusters</a></span><span class="op">(</span><span class="va">seu_obj_1</span><span class="op">)</span></span>
<span><span class="va">seu_obj_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://satijalab.org/seurat/reference/RunUMAP.html" class="external-link">RunUMAP</a></span><span class="op">(</span><span class="va">seu_obj_1</span>, dims <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">seu_obj_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://satijalab.org/seurat/reference/CellCycleScoring.html" class="external-link">CellCycleScoring</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">seu_obj_1</span>,</span>
<span>                              g2m.features <span class="op">=</span> <span class="va">cc.genes.updated.2019</span><span class="op">$</span><span class="va">g2m.genes</span>,</span>
<span>                              s.features <span class="op">=</span> <span class="va">cc.genes.updated.2019</span><span class="op">$</span><span class="va">s.genes</span><span class="op">)</span></span></code></pre></div>
<p>The genes-by-cells count matrix available at NCBI GEO is provided
with Ensembl identifiers and gene symbols, which are not unique. So,
after having read the table, we used the function
<code>keep_strongest_representative</code>, which defines a
genes-by-cells matrix with symbols as row names. In case of multiple
Ensembl ids mapped to the same symbol, the row with the highest average
count is kept as representative of the gene.</p>
<p>In a real scenario, <strong>the functions listed above should be run
using appropriate parameter values</strong> that take into account the
specificities of the dataset under consideration and the objectives of
the analysis to perform. Here we just wanted to provide a means to
obtain a dataset to follow this vignette. Please read the Seurat
documentation for further details about the functions listed above.</p>
</div>
<div class="section level2">
<h2 id="the-scmuffinlist-data-structure">The scMuffinList data structure<a class="anchor" aria-label="anchor" href="#the-scmuffinlist-data-structure"></a>
</h2>
<p>All data and results of scMuffin are stored in the scMuffinList, so
that every function takes in input such structure and returns a modified
version of it. The scMuffinList can be created as follows:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">scML</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_scMuffinList.html">create_scMuffinList</a></span><span class="op">(</span>counts <span class="op">=</span> <span class="fu"><a href="https://mojaveazure.github.io/seurat-object/reference/AssayData.html" class="external-link">GetAssayData</a></span><span class="op">(</span><span class="va">seu_obj_1</span>, assay <span class="op">=</span> <span class="st">"RNA"</span>, slot <span class="op">=</span> <span class="st">"counts"</span><span class="op">)</span>, </span>
<span>                            normalized <span class="op">=</span> <span class="fu"><a href="https://mojaveazure.github.io/seurat-object/reference/AssayData.html" class="external-link">GetAssayData</a></span><span class="op">(</span><span class="va">seu_obj_1</span>, assay <span class="op">=</span> <span class="st">"RNA"</span>, slot <span class="op">=</span> <span class="st">"data"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Many analyses require cell clusters. Any partition can be added as
follows:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">scML</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_partitions.html">add_partitions</a></span><span class="op">(</span><span class="va">scML</span>, </span>
<span>                       clusters <span class="op">=</span> <span class="va">seu_obj_1</span><span class="op">$</span><span class="va">seurat_clusters</span>, </span>
<span>                       partition_id <span class="op">=</span> <span class="st">"global_expr"</span><span class="op">)</span></span></code></pre></div>
<p>where <code>seu_obj_1$seurat_clusters</code> is a named vector that
contains cells clusters and whose names are cell labels. The element
<code>partitions</code> of <code>scML</code> will contain cell
clusters:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">scML</span><span class="op">$</span><span class="va">partitions</span><span class="op">[</span>, <span class="fl">1</span>, drop <span class="op">=</span> <span class="cn">F</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    global_expr</span></span>
<span><span class="co">## V3           2</span></span>
<span><span class="co">## V4           2</span></span>
<span><span class="co">## V5           6</span></span>
<span><span class="co">## V6           2</span></span>
<span><span class="co">## V7           6</span></span>
<span><span class="co">## V8           6</span></span></code></pre>
<p>The function <code><a href="../reference/add_features.html">add_features()</a></code> can be used to add custom
results to the <code>scMuffinList</code>. In the following example we
add the cell cycle phase:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">scML</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_features.html">add_features</a></span><span class="op">(</span><span class="va">scML</span>, name <span class="op">=</span> <span class="st">"CC_Phase"</span>, </span>
<span>                     summary <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>CC_Phase <span class="op">=</span> <span class="va">seu_obj_1</span><span class="op">$</span><span class="va">Phase</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">scML</span><span class="op">$</span><span class="va">CC_Phase</span><span class="op">$</span><span class="va">summary</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    CC_Phase</span></span>
<span><span class="co">## V3 "G2M"   </span></span>
<span><span class="co">## V4 "S"     </span></span>
<span><span class="co">## V5 "G1"    </span></span>
<span><span class="co">## V6 "G2M"   </span></span>
<span><span class="co">## V7 "G1"    </span></span>
<span><span class="co">## V8 "G1"</span></span></code></pre>
<p>The <code>summary</code> element of the scMuffinList is a data.frame
intended to contain data about the feature, while element
<code>full</code> can be used to store other supporting feature data
(see other examples below).</p>
</div>
<div class="section level2">
<h2 id="gene-set-scoring">Gene set scoring<a class="anchor" aria-label="anchor" href="#gene-set-scoring"></a>
</h2>
<p>scMuffin provides functions to set up one or more collections of gene
sets and perform cell-level estimation of gene set expression in
relation to an empirical null model. This can be applied to any gene set
and can therefore be used to estimate various cells’ phenotypes, like
pathway activities or markers expression.</p>
<div class="section level3">
<h3 id="assembling-input-gene-sets">Assembling input gene sets<a class="anchor" aria-label="anchor" href="#assembling-input-gene-sets"></a>
</h3>
<p>The function <code>prepare_gsls</code> retrieves gene sets from
CellMarker <span class="citation">(Zhang et al. 2019)</span>, PanglaoDB
<span class="citation">(Franzén, Gan, and Björkegren 2019)</span>,
CancerSEA <span class="citation">(H. Yuan et al. 2019)</span> and MSigDB
<span class="citation">(Subramanian et al. 2005)</span>, and accepts
custom gene set as well. The full list of gene sets available whitin
CellMarker, PanglaoDB and CancerSEA collections can be listed using:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"gsls_EntrezID"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"gsls_Symbol"</span><span class="op">)</span></span></code></pre></div>
<p>while in the case of MSigDB we can use its dedicated functions:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">msigdbr</span><span class="fu">::</span><span class="fu"><a href="https://igordot.github.io/msigdbr/reference/msigdbr_collections.html" class="external-link">msigdbr_collections</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu">msigdbr</span><span class="fu">::</span><span class="fu"><a href="https://igordot.github.io/msigdbr/reference/msigdbr_species.html" class="external-link">msigdbr_species</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>The gene sets of interest can be selected acting on the corresponding
arguments <code>CM_tissues</code>, <code>PNDB_tissues</code>, and
<code>msigdb_hs_cat_subcat</code>. In the case of CellMarker and
PanglaoDB we can specify a list of desired tissues. The full set can be
listed by means of show_tissues. Here we show just the first part of the
output:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="../reference/show_tissues.html">show_tissues</a></span><span class="op">(</span><span class="op">)</span>, <span class="va">head</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $PNDB</span></span>
<span><span class="co">## [1] "Adrenal_glands"    "Blood"             "Bone"             </span></span>
<span><span class="co">## [4] "Brain"             "Connective_tissue" "Embryo"           </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $CM_normal</span></span>
<span><span class="co">## [1] "Abdominal_adipose_tissue" "Adipose_tissue"          </span></span>
<span><span class="co">## [3] "Adrenal_gland"            "Adventitia"              </span></span>
<span><span class="co">## [5] "Airway_epithelium"        "Amniotic_fluid"          </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $CM_cancer</span></span>
<span><span class="co">## [1] "Adipose_tissue" "Ascites"        "Bladder"        "Blood"         </span></span>
<span><span class="co">## [5] "Blood_vessel"   "Bone"</span></span></code></pre>
<p>Here is an example:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gsc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prepare_gsls.html">prepare_gsls</a></span><span class="op">(</span>gs_sources <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CancerSEA"</span>, <span class="st">"PNDB"</span><span class="op">)</span>, </span>
<span>                    PNDB_tissues <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Brain"</span><span class="op">)</span>, </span>
<span>                    scMuffinList <span class="op">=</span> <span class="va">scML</span>, </span>
<span>                    genes_min <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p>Note that in the case of MSigDB we have to set up a
<code>data.frame</code> to specify species, category and sub_category of
the gene set collections.</p>
</div>
<div class="section level3">
<h3 id="calculate-gene-set-scores-at-cell-and-cluster-level">Calculate Gene set scores at cell and cluster level<a class="anchor" aria-label="anchor" href="#calculate-gene-set-scores-at-cell-and-cluster-level"></a>
</h3>
<p>In the following example, we estimate the scores for CancerSEA gene
sets:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">scML</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_gs_scores.html">calculate_gs_scores</a></span><span class="op">(</span>scMuffinList <span class="op">=</span> <span class="va">scML</span>, </span>
<span>                            gs_list <span class="op">=</span> <span class="va">gsc</span><span class="op">$</span><span class="va">CancerSEA</span><span class="op">)</span></span></code></pre></div>
<p>The results of any analysis are stored as elements of the
<code>scML</code>. The gene set scoring engine stores its results in
<code>scML$gene_set_scoring</code>, where <code>summary</code> is a
cells-by-features data.frame with cell scores, and <code>full</code>
contains a series of additional details for every gene set:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">scML</span><span class="op">$</span><span class="va">gene_set_scoring</span><span class="op">$</span><span class="va">summary</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">scML</span><span class="op">$</span><span class="va">gene_set_scoring</span><span class="op">$</span><span class="va">full</span><span class="op">$</span><span class="va">Angiogenesis</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    Angiogenesis    Apoptosis  Cell_Cycle Differentiation DNA_damage</span></span>
<span><span class="co">## V3  -0.10918589 -0.027672315  0.14448128       0.2177449 0.10625520</span></span>
<span><span class="co">## V4  -0.02872848  0.065879018  0.28261124       0.2546351 0.28273733</span></span>
<span><span class="co">## V5   0.08863655 -0.003487231 -0.04785548       0.1568680 0.14740373</span></span>
<span><span class="co">## V6  -0.10802785 -0.010414814  0.36535484       0.2201350 0.16137969</span></span>
<span><span class="co">## V7   0.09552221  0.214845193 -0.13056901       0.1659778 0.01677083</span></span>
<span><span class="co">## V8   0.14137853  0.267301590 -0.10286473       0.1054560 0.09103363</span></span>
<span><span class="co">##      DNA_repair        EMT     Hypoxia Inflammation  Invasion Metastasis</span></span>
<span><span class="co">## V3  0.148348585 0.05265334  0.09262748  0.009633798 0.3169777  0.2093022</span></span>
<span><span class="co">## V4  0.181192508 0.13265908  0.12957070  0.050349840 0.5034789  0.2555932</span></span>
<span><span class="co">## V5 -0.011344590 0.22409580  0.41523704  0.111271235 0.2040137  0.3528524</span></span>
<span><span class="co">## V6  0.163828298 0.26049885 -0.03046142  0.005814202 0.5683223  0.1564824</span></span>
<span><span class="co">## V7 -0.071774957 0.35638003  0.39819922  0.004184621 0.3586581  0.3512004</span></span>
<span><span class="co">## V8  0.001900824 0.23221609  0.32485036 -0.015495107 0.2552769  0.4519555</span></span>
<span><span class="co">##    Proliferation  Quiescence  Stemness</span></span>
<span><span class="co">## V3    0.19624494 -0.10718702 0.4275265</span></span>
<span><span class="co">## V4    0.31782667  0.14023972 0.6338283</span></span>
<span><span class="co">## V5    0.13657056  0.00557050 0.2942666</span></span>
<span><span class="co">## V6    0.16174960  0.06201775 0.5979552</span></span>
<span><span class="co">## V7    0.17320576  0.03903302 0.2387523</span></span>
<span><span class="co">## V8   -0.03581073  0.07383093 0.2218311</span></span></code></pre>
<pre><code><span><span class="co">##         case case.N case.AV nmark_min avg_control control.AV null_ok</span></span>
<span><span class="co">## V3 0.6209460     40      21      TRUE   0.7301319        100    TRUE</span></span>
<span><span class="co">## V4 0.7282336     40      20      TRUE   0.7569621        100    TRUE</span></span>
<span><span class="co">## V5 0.8418314     40      23      TRUE   0.7531949        100    TRUE</span></span>
<span><span class="co">## V6 0.6632416     40      16      TRUE   0.7712694        100    TRUE</span></span>
<span><span class="co">## V7 0.8363020     40      23      TRUE   0.7407798        100    TRUE</span></span>
<span><span class="co">## V8 0.8964932     40      19      TRUE   0.7551147        100    TRUE</span></span>
<span><span class="co">##    avg_delta_score delta_score</span></span>
<span><span class="co">## V3     -0.10918589 -0.10918589</span></span>
<span><span class="co">## V4     -0.02872848 -0.02872848</span></span>
<span><span class="co">## V5      0.08863655  0.08863655</span></span>
<span><span class="co">## V6     -0.10802785 -0.10802785</span></span>
<span><span class="co">## V7      0.09552221  0.09552221</span></span>
<span><span class="co">## V8      0.14137853  0.14137853</span></span></code></pre>
<p>The values of cell-level scores can be used to color UMAP
visualizations, which are automatically generated for every gene set
using:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_umap_colored_features.html">plot_umap_colored_features</a></span><span class="op">(</span>scMuffinList <span class="op">=</span> <span class="va">scML</span>, </span>
<span>                           Seu_obj <span class="op">=</span> <span class="va">seu_obj_1</span>, </span>
<span>                           feature_name <span class="op">=</span> <span class="st">"gene_set_scoring"</span><span class="op">)</span></span></code></pre></div>
<p>Here below, an example of UMAP visualization where cells are colored
by CancerSEA “Hypoxia” gene set score.</p>
<div class="figure">
<img src="images/umap_by_genes_col_feature_Hypoxia.jpg" width="600" alt=""><p class="caption">caption</p>
</div>
<p>The function <code>calculate_gs_scores_in_clusters</code> defines the
median values of gene set scores in every cluster of a given partition
id:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">scML</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_gs_scores_in_clusters.html">calculate_gs_scores_in_clusters</a></span><span class="op">(</span>scMuffinList <span class="op">=</span> <span class="va">scML</span>, </span>
<span>                                        partition_id <span class="op">=</span> <span class="st">"global_expr"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">scML</span><span class="op">$</span><span class="va">cluster_data</span><span class="op">$</span><span class="va">global_expr</span><span class="op">$</span><span class="va">gene_set_scoring</span><span class="op">$</span><span class="va">summary</span></span></code></pre></div>
<pre><code><span><span class="co">##   Angiogenesis    Apoptosis  Cell_Cycle Differentiation DNA_damage   DNA_repair</span></span>
<span><span class="co">## 0  0.005206236  0.019249002 -0.06447346      0.10079093 0.08386659 -0.015634375</span></span>
<span><span class="co">## 1  0.022524297  0.052477813 -0.02173267      0.16058731 0.15353017 -0.016262480</span></span>
<span><span class="co">## 2  0.016285304 -0.077046033  0.09287226      0.16931117 0.14490958  0.104084184</span></span>
<span><span class="co">## 3 -0.011020301 -0.004544935 -0.06073645      0.09458853 0.11932908 -0.001509004</span></span>
<span><span class="co">## 4  0.022337656  0.021403192 -0.04759109      0.14014722 0.12942893 -0.024110561</span></span>
<span><span class="co">## 5 -0.031611017 -0.042869916  0.02839297      0.15244780 0.22201017  0.067711722</span></span>
<span><span class="co">## 6  0.132965431  0.028446423 -0.05078115      0.17077833 0.11716633 -0.035208636</span></span>
<span><span class="co">## 7  0.083809559 -0.027496365  0.01100746      0.15875134 0.20662126  0.027456269</span></span>
<span><span class="co">## 8  0.009743315 -0.072038549  0.28456623      0.24816174 0.16453499  0.118506158</span></span>
<span><span class="co">##         EMT      Hypoxia Inflammation   Invasion Metastasis Proliferation</span></span>
<span><span class="co">## 0 0.1958425  0.152775367  0.007683201 0.02659866 0.24715672    0.01822001</span></span>
<span><span class="co">## 1 0.2445520  0.300890417  0.129862284 0.15558955 0.31501115    0.02251154</span></span>
<span><span class="co">## 2 0.1556018 -0.011922956 -0.003003220 0.38545997 0.10925866    0.16892359</span></span>
<span><span class="co">## 3 0.2323454  0.267548254  0.086860333 0.09265066 0.24611511    0.12064441</span></span>
<span><span class="co">## 4 0.2101481  0.262389267  0.056573420 0.17563272 0.29081642    0.03197286</span></span>
<span><span class="co">## 5 0.1895798 -0.046625305  0.028563842 0.20228425 0.06788279    0.03974853</span></span>
<span><span class="co">## 6 0.3314966  0.287708428  0.080396645 0.20701318 0.37491821   -0.02531225</span></span>
<span><span class="co">## 7 0.1290949 -0.044477324 -0.003007760 0.19486268 0.10988028    0.05104020</span></span>
<span><span class="co">## 8 0.1226556  0.004651646  0.035257815 0.49988275 0.14005943    0.39134694</span></span>
<span><span class="co">##     Quiescence  Stemness</span></span>
<span><span class="co">## 0 -0.014092199 0.2370518</span></span>
<span><span class="co">## 1  0.086151276 0.2942516</span></span>
<span><span class="co">## 2  0.029009746 0.3854771</span></span>
<span><span class="co">## 3  0.148241530 0.3829096</span></span>
<span><span class="co">## 4 -0.003897101 0.2378097</span></span>
<span><span class="co">## 5 -0.054270405 0.3662737</span></span>
<span><span class="co">## 6  0.073751645 0.2388921</span></span>
<span><span class="co">## 7  0.040777466 0.4215733</span></span>
<span><span class="co">## 8  0.006650415 0.4348696</span></span></code></pre>
<p>These mean values are useful to obtain a concise visualization of
gene set expression throughout the dataset, using the function
<code>plot_heatmap_features_by_clusters</code>:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_heatmap_features_by_clusters.html">plot_heatmap_features_by_clusters</a></span><span class="op">(</span>scMuffinList <span class="op">=</span> <span class="va">scML</span>, </span>
<span>                                  feature_source <span class="op">=</span> <span class="st">"gss"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="images/heatmap_features_by_clusters.png" width="600" alt=""><p class="caption">caption</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="cnv-inference">CNV inference<a class="anchor" aria-label="anchor" href="#cnv-inference"></a>
</h2>
<div class="section level3">
<h3 id="cnv-calculation">CNV calculation<a class="anchor" aria-label="anchor" href="#cnv-calculation"></a>
</h3>
<p>CNV inference is performed by the function
<code>CNV_analysis</code>.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">scML</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/CNV_analysis.html">CNV_analysis</a></span><span class="op">(</span><span class="va">scML</span><span class="op">)</span></span></code></pre></div>
<p>The results are stored in <code>scML$CNV</code>, where:</p>
<ul>
<li>
<code>summary</code> contains the CNV score;</li>
<li>
<code>scML$CNV$full$CNV</code> contains the regions-by-cells matrix
of CNV profiles;</li>
<li>
<code>scML$CNV$full$regions2genes</code> is important to map the
original data into the CNV regions;</li>
<li>
<code>scML$CNV$full$detected_cnv_regions</code> is a data.frame that
list the CNV regions detected in each chromosome and cell cluster:</li>
</ul>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">scML</span><span class="op">$</span><span class="va">CNV</span><span class="op">$</span><span class="va">summary</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">scML</span><span class="op">$</span><span class="va">CNV</span><span class="op">$</span><span class="va">full</span><span class="op">$</span><span class="va">CNV</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">scML</span><span class="op">$</span><span class="va">CNV</span><span class="op">$</span><span class="va">full</span><span class="op">$</span><span class="va">regions2genes</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">scML</span><span class="op">$</span><span class="va">CNV</span><span class="op">$</span><span class="va">full</span><span class="op">$</span><span class="va">detected_cnv_regions</span><span class="op">$</span><span class="va">chr1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    CNV_score</span></span>
<span><span class="co">## V3  42.61237</span></span>
<span><span class="co">## V4  49.29867</span></span>
<span><span class="co">## V5  40.00239</span></span>
<span><span class="co">## V6  45.42658</span></span>
<span><span class="co">## V7  37.62340</span></span>
<span><span class="co">## V8  45.69161</span></span></code></pre>
<pre><code><span><span class="co">##                                                            V3         V4</span></span>
<span><span class="co">## chr1__826205__LINC00115__chr1__15807161__UQCRHL   -0.09701447 -0.1335597</span></span>
<span><span class="co">## chr1__827590__LINC01128__chr1__15834214__FLJ37453 -0.09701447 -0.1335597</span></span>
<span><span class="co">## chr1__923922__SAMD11__chr1__15847706__SPEN        -0.10029463 -0.1368559</span></span>
<span><span class="co">## chr1__944202__NOC2L__chr1__15941868__ZBTB17       -0.10029463 -0.1291166</span></span>
<span><span class="co">## chr1__998963__HES4__chr1__16246839__FBXO42        -0.10357480 -0.1233517</span></span>
<span><span class="co">## chr1__1013496__ISG15__chr1__16367241__SZRD1       -0.10357480 -0.1208830</span></span>
<span><span class="co">##                                                            V5          V6</span></span>
<span><span class="co">## chr1__826205__LINC00115__chr1__15807161__UQCRHL   -0.08801707 -0.08020141</span></span>
<span><span class="co">## chr1__827590__LINC01128__chr1__15834214__FLJ37453 -0.08801707 -0.08020141</span></span>
<span><span class="co">## chr1__923922__SAMD11__chr1__15847706__SPEN        -0.08801707 -0.08020141</span></span>
<span><span class="co">## chr1__944202__NOC2L__chr1__15941868__ZBTB17       -0.08801707 -0.07690028</span></span>
<span><span class="co">## chr1__998963__HES4__chr1__16246839__FBXO42        -0.08801707 -0.08267282</span></span>
<span><span class="co">## chr1__1013496__ISG15__chr1__16367241__SZRD1       -0.08801707 -0.07937168</span></span>
<span><span class="co">##                                                            V7         V8</span></span>
<span><span class="co">## chr1__826205__LINC00115__chr1__15807161__UQCRHL   -0.09343743 -0.1312566</span></span>
<span><span class="co">## chr1__827590__LINC01128__chr1__15834214__FLJ37453 -0.09013095 -0.1312566</span></span>
<span><span class="co">## chr1__923922__SAMD11__chr1__15847706__SPEN        -0.09013095 -0.1254576</span></span>
<span><span class="co">## chr1__944202__NOC2L__chr1__15941868__ZBTB17       -0.09013095 -0.1221395</span></span>
<span><span class="co">## chr1__998963__HES4__chr1__16246839__FBXO42        -0.09343743 -0.1188214</span></span>
<span><span class="co">## chr1__1013496__ISG15__chr1__16367241__SZRD1       -0.09343743 -0.1155033</span></span>
<span><span class="co">##                                                           V9        V10</span></span>
<span><span class="co">## chr1__826205__LINC00115__chr1__15807161__UQCRHL   -0.1363821 -0.1140620</span></span>
<span><span class="co">## chr1__827590__LINC01128__chr1__15834214__FLJ37453 -0.1397023 -0.1140620</span></span>
<span><span class="co">## chr1__923922__SAMD11__chr1__15847706__SPEN        -0.1363821 -0.1106926</span></span>
<span><span class="co">## chr1__944202__NOC2L__chr1__15941868__ZBTB17       -0.1363821 -0.1140620</span></span>
<span><span class="co">## chr1__998963__HES4__chr1__16246839__FBXO42        -0.1363821 -0.1140620</span></span>
<span><span class="co">## chr1__1013496__ISG15__chr1__16367241__SZRD1       -0.1363821 -0.1106926</span></span>
<span><span class="co">##                                                          V11         V12</span></span>
<span><span class="co">## chr1__826205__LINC00115__chr1__15807161__UQCRHL   0.03868385 -0.08410502</span></span>
<span><span class="co">## chr1__827590__LINC01128__chr1__15834214__FLJ37453 0.04206464 -0.08410502</span></span>
<span><span class="co">## chr1__923922__SAMD11__chr1__15847706__SPEN        0.04796102 -0.08410502</span></span>
<span><span class="co">## chr1__944202__NOC2L__chr1__15941868__ZBTB17       0.05385741 -0.08067802</span></span>
<span><span class="co">## chr1__998963__HES4__chr1__16246839__FBXO42        0.05637300 -0.08067802</span></span>
<span><span class="co">## chr1__1013496__ISG15__chr1__16367241__SZRD1       0.05975379 -0.07471005</span></span></code></pre>
<pre><code><span><span class="co">## $chr1__826205__LINC00115__chr1__15807161__UQCRHL</span></span>
<span><span class="co">##         chr      pos    symbol</span></span>
<span><span class="co">## X11.1  chr1   826205 LINC00115</span></span>
<span><span class="co">## X12.1  chr1   827590 LINC01128</span></span>
<span><span class="co">## X13.1  chr1   923922    SAMD11</span></span>
<span><span class="co">## X14.1  chr1   944202     NOC2L</span></span>
<span><span class="co">## X15.1  chr1   998963      HES4</span></span>
<span><span class="co">## X16.1  chr1  1013496     ISG15</span></span>
<span><span class="co">## X17.1  chr1  1216930      SDF4</span></span>
<span><span class="co">## X18.1  chr1  1232236   B3GALT6</span></span>
<span><span class="co">## X19.1  chr1  1253911    UBE2J2</span></span>
<span><span class="co">## X110.1 chr1  1280435    SCNN1D</span></span>
<span><span class="co">## X111.1 chr1  1292390     ACAP3</span></span>
<span><span class="co">## X112.1 chr1  1308579     PUSL1</span></span>
<span><span class="co">## X113.1 chr1  1324801      CPTP</span></span>
<span><span class="co">## X114.1 chr1  1335277      DVL1</span></span>
<span><span class="co">## X115.1 chr1  1352688     MXRA8</span></span>
<span><span class="co">## X116.1 chr1  1373735  AURKAIP1</span></span>
<span><span class="co">## X117.1 chr1  1385710     CCNL2</span></span>
<span><span class="co">## X118.1 chr1  1401908    MRPL20</span></span>
<span><span class="co">## X119.1 chr1  1449688    ATAD3C</span></span>
<span><span class="co">## X120.1 chr1  1471764    ATAD3B</span></span>
<span><span class="co">## X121.1 chr1  1512161    ATAD3A</span></span>
<span><span class="co">## X122.1 chr1  1534777   TMEM240</span></span>
<span><span class="co">## X123.1 chr1  1541672     SSU72</span></span>
<span><span class="co">## X124.1 chr1  1615854      MIB2</span></span>
<span><span class="co">## X125.1 chr1  1635224    CDK11B</span></span>
<span><span class="co">## X126.1 chr1  1661477  SLC35E2B</span></span>
<span><span class="co">## X127.1 chr1  1751231      NADK</span></span>
<span><span class="co">## X128.1 chr1  1785284      GNB1</span></span>
<span><span class="co">## X129.1 chr1  2189548    FAAP20</span></span>
<span><span class="co">## X130.1 chr1  2228318       SKI</span></span>
<span><span class="co">## X131.1 chr1  2391840      RER1</span></span>
<span><span class="co">## X132.1 chr1  2403973     PEX10</span></span>
<span><span class="co">## X133.1 chr1  2508536     PANK4</span></span>
<span><span class="co">## X134.1 chr1  2528744      HES5</span></span>
<span><span class="co">## X135.1 chr1  2556364  TNFRSF14</span></span>
<span><span class="co">## X136.1 chr1  3625014    TPRG1L</span></span>
<span><span class="co">## X137.1 chr1  3630769    WRAP73</span></span>
<span><span class="co">## X138.1 chr1  3778558    LRRC47</span></span>
<span><span class="co">## X139.1 chr1  3812085    CEP104</span></span>
<span><span class="co">## X140.1 chr1  3889132  C1orf174</span></span>
<span><span class="co">## X141.1 chr1  6185019     RPL22</span></span>
<span><span class="co">## X142.1 chr1  6221192      ICMT</span></span>
<span><span class="co">## X143.1 chr1  6247352    GPR153</span></span>
<span><span class="co">## X144.1 chr1  6264271     ACOT7</span></span>
<span><span class="co">## X145.1 chr1  6460785  TNFRSF25</span></span>
<span><span class="co">## X146.1 chr1  6467121   PLEKHG5</span></span>
<span><span class="co">## X147.1 chr1  6521346      NOL9</span></span>
<span><span class="co">## X148.1 chr1  6579993    ZBTB48</span></span>
<span><span class="co">## X149.1 chr1  6590723    KLHL21</span></span>
<span><span class="co">## X150.1 chr1  6613730     PHF13</span></span>
<span><span class="co">## X151.1 chr1  6625149     THAP3</span></span>
<span><span class="co">## X152.1 chr1  6634169   DNAJC11</span></span>
<span><span class="co">## X153.1 chr1  6785453    CAMTA1</span></span>
<span><span class="co">## X154.1 chr1  7771295     VAMP3</span></span>
<span><span class="co">## X155.1 chr1  7784428      PER3</span></span>
<span><span class="co">## X156.1 chr1  7961710     PARK7</span></span>
<span><span class="co">## X157.1 chr1  8011726    ERRFI1</span></span>
<span><span class="co">## X158.1 chr1  8352403      RERE</span></span>
<span><span class="co">## X159.1 chr1  8860999      ENO1</span></span>
<span><span class="co">## X160.1 chr1  9148010  MIR34AHG</span></span>
<span><span class="co">## X161.1 chr1  9234773      H6PD</span></span>
<span><span class="co">## X162.1 chr1  9292893     SPSB1</span></span>
<span><span class="co">## X163.1 chr1  9539464  SLC25A33</span></span>
<span><span class="co">## X164.1 chr1  9588910   TMEM201</span></span>
<span><span class="co">## X165.1 chr1  9728925    CLSTN1</span></span>
<span><span class="co">## X166.1 chr1  9848275  CTNNBIP1</span></span>
<span><span class="co">## X167.1 chr1  9922117      LZIC</span></span>
<span><span class="co">## X168.1 chr1  9942922    NMNAT1</span></span>
<span><span class="co">## X169.1 chr1 10032957     UBE4B</span></span>
<span><span class="co">## X170.1 chr1 10210705     KIF1B</span></span>
<span><span class="co">## X171.1 chr1 10399063       PGD</span></span>
<span><span class="co">## X172.1 chr1 10460545      DFFA</span></span>
<span><span class="co">## X173.1 chr1 10474949     PEX14</span></span>
<span><span class="co">## X174.1 chr1 10647210     CASZ1</span></span>
<span><span class="co">## X175.1 chr1 11012653    TARDBP</span></span>
<span><span class="co">## X176.1 chr1 11054589       SRM</span></span>
<span><span class="co">## X177.1 chr1 11066618   EXOSC10</span></span>
<span><span class="co">## X178.1 chr1 11106534      MTOR</span></span>
<span><span class="co">## X179.1 chr1 11273197    UBIAD1</span></span>
<span><span class="co">## X180.1 chr1 11654406    FBXO44</span></span>
<span><span class="co">## X181.1 chr1 11674479    MAD2L2</span></span>
<span><span class="co">## X182.1 chr1 11691709    DRAXIN</span></span>
<span><span class="co">## X183.1 chr1 11736084    AGTRAP</span></span>
<span><span class="co">## X184.1 chr1 11785725     MTHFR</span></span>
<span><span class="co">## X185.1 chr1 11806095     CLCN6</span></span>
<span><span class="co">## X186.1 chr1 11845709      NPPA</span></span>
<span><span class="co">## X187.1 chr1 11919590  KIAA2013</span></span>
<span><span class="co">## X188.1 chr1 11934716     PLOD1</span></span>
<span><span class="co">## X189.1 chr1 11980443      MFN2</span></span>
<span><span class="co">## X190.1 chr1 12019497      MIIP</span></span>
<span><span class="co">## X191.1 chr1 12230029    VPS13D</span></span>
<span><span class="co">## X192.1 chr1 12567909     DHRS3</span></span>
<span><span class="co">## X193.1 chr1 13749414     PRDM2</span></span>
<span><span class="co">## X194.1 chr1 14945918      KAZN</span></span>
<span><span class="co">## X195.1 chr1 15409887     EFHD2</span></span>
<span><span class="co">## X196.1 chr1 15491400     CASP9</span></span>
<span><span class="co">## X197.1 chr1 15526847   DNAJC16</span></span>
<span><span class="co">## X198.1 chr1 15617457      DDI2</span></span>
<span><span class="co">## X199.1 chr1 15684319   PLEKHM2</span></span>
<span><span class="co">## X1100  chr1 15758794    FBLIM1</span></span>
<span><span class="co">## X1101  chr1 15807161    UQCRHL</span></span></code></pre>
<pre><code><span><span class="co">##     chr                                            start start.loc</span></span>
<span><span class="co">## 1  chr1  chr1__826205__LINC00115__chr1__15807161__UQCRHL    826205</span></span>
<span><span class="co">## 3  chr1   chr1__113929323__HIPK1__chr1__153633981__CHTOP 113929323</span></span>
<span><span class="co">## 5  chr1   chr1__169132530__NME7__chr1__203127725__ADORA1 169132530</span></span>
<span><span class="co">## 6  chr1  chr1__826205__LINC00115__chr1__15807161__UQCRHL    826205</span></span>
<span><span class="co">## 35 chr1  chr1__826205__LINC00115__chr1__15807161__UQCRHL    826205</span></span>
<span><span class="co">## 38 chr1 chr1__93180715__CCDC18__chr1__144887287__SRGAP2B  93180715</span></span>
<span><span class="co">##                                               stop  stop.loc cluster    length</span></span>
<span><span class="co">## 1    chr1__9588910__TMEM201__chr1__25884178__STMN1  25884178       0  25057973</span></span>
<span><span class="co">## 3   chr1__153990761__RPS27__chr1__162497804__UHMK1 162497804       0  48568481</span></span>
<span><span class="co">## 5  chr1__169792531__METTL18__chr1__203305518__BTG2 203305518       0  34172988</span></span>
<span><span class="co">## 6   chr1__213988532__PROX1__chr1__244653125__DESI2 244653125       1 243826920</span></span>
<span><span class="co">## 35     chr1__9234773__H6PD__chr1__25616790__MAN1C1  25616790       2  24790585</span></span>
<span><span class="co">## 38    chr1__154161812__TPM3__chr1__162561898__UAP1 162561898       2  69381183</span></span></code></pre>
<p>Importantly, CNV inference adds the “CNV” partition:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">scML</span><span class="op">$</span><span class="va">partitions</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    global_expr CNV</span></span>
<span><span class="co">## V3           2   1</span></span>
<span><span class="co">## V4           2   1</span></span>
<span><span class="co">## V5           6   0</span></span>
<span><span class="co">## V6           2   1</span></span>
<span><span class="co">## V7           6   0</span></span>
<span><span class="co">## V8           6   2</span></span></code></pre>
<p>The calculation can be demanding. For example, it requires
approximately 10 minutes on 2 cores (dual Intel(R) Xeon(R),
2.60GHz).</p>
</div>
<div class="section level3">
<h3 id="cnv-visualization">CNV visualization<a class="anchor" aria-label="anchor" href="#cnv-visualization"></a>
</h3>
<p>scMuffin provides two visualizations for CNVs: an heatmap and the
cluster average profile plot. The heatmap is based on ComnplexHeatmap
package and enables the visualization of the genomic location of a
series of given genes (specified in the argument <code>genes</code>),
or, alternatively, the location of detected CNVs (argument
<code>mark.detected.cnv = T</code>)</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">col_fun</span> <span class="op">&lt;-</span> <span class="fu">circlize</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/circlize/man/colorRamp2.html" class="external-link">colorRamp2</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.2</span>, <span class="fl">0.2</span>, length.out <span class="op">=</span> <span class="fl">11</span><span class="op">)</span>, </span>
<span>                                <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="fu">pals</span><span class="fu">::</span><span class="fu"><a href="https://kwstat.github.io/pals/reference/brewer.html" class="external-link">brewer.rdylbu</a></span><span class="op">(</span><span class="fl">11</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/heatmap_CNV.html">heatmap_CNV</a></span><span class="op">(</span>scMuffinList <span class="op">=</span> <span class="va">scML</span>, </span>
<span>            genes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"YBX1"</span>, <span class="st">"HNRNPM"</span><span class="op">)</span>, </span>
<span>            genes.labels <span class="op">=</span> <span class="cn">T</span>, </span>
<span>            col <span class="op">=</span> <span class="va">col_fun</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/heatmap_CNV.html">heatmap_CNV</a></span><span class="op">(</span>scMuffinList <span class="op">=</span> <span class="va">scML</span>, mark.detected.cnv <span class="op">=</span> <span class="cn">T</span>, col<span class="op">=</span><span class="va">col_fun</span><span class="op">)</span></span></code></pre></div>
<p><img src="images/heatmap_CNV_PJ016_vignette_genes.png" width="600" alt="caption"><img src="images/heatmap_CNV_PJ016_vignette_cnv.png" width="600"></p>
<p>The function <code>plot_profile_CNV</code> plots the median CNV
profile of a cluster:</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_profile_CNV.html">plot_profile_CNV</a></span><span class="op">(</span>scMuffinList <span class="op">=</span> <span class="va">scML</span>, cluster <span class="op">=</span> <span class="fl">0</span>, cex.points <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> </span></code></pre></div>
<p><img src="images/CNV_profile_0.png" width="600"></p>
</div>
</div>
<div class="section level2">
<h2 id="transcriptional-complexity">Transcriptional complexity<a class="anchor" aria-label="anchor" href="#transcriptional-complexity"></a>
</h2>
<p>The transcriptional complexity (TC) can be quantified by means of the
function <code>transcr_compl</code>. The corresponding summary element
contains a <code>data.frame</code> with the number of cell transcripts,
the number of genes detected in every cell, the TC-ratio (C), the TC-LMR
(linear model residual) and the TC-H (entropy):</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">scML</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/transcr_compl.html">transcr_compl</a></span><span class="op">(</span><span class="va">scML</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">scML</span><span class="op">$</span><span class="va">transcr_compl</span><span class="op">$</span><span class="va">summary</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    tot_counts n_genes         C        H          LM</span></span>
<span><span class="co">## V3      16228    1051 0.8628900 6.522372 -0.02561130</span></span>
<span><span class="co">## V4      14286    1168 1.0893060 6.736431  0.06164645</span></span>
<span><span class="co">## V5      15857    1217 1.0225564 6.602594  0.04559174</span></span>
<span><span class="co">## V6      15157    1208 1.0618701 6.763307  0.05703916</span></span>
<span><span class="co">## V7      15609    1171 0.9995385 6.535546  0.03398037</span></span>
<span><span class="co">## V8      15286    1218 1.0616250 6.685640  0.05786558</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="cell-proliferation-rate">Cell proliferation rate<a class="anchor" aria-label="anchor" href="#cell-proliferation-rate"></a>
</h2>
<p>Cell proliferation is quantified considering the maximum between the
two scores of G1/S and G2/M gene sets:</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">scML</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/proliferation_analysis.html">proliferation_analysis</a></span><span class="op">(</span>scMuffinList <span class="op">=</span> <span class="va">scML</span><span class="op">)</span></span></code></pre></div>
<p>The proliferation score is stored in the <code>summary</code> element
of <code>scML$proliferation</code>:</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">scML</span><span class="op">$</span><span class="va">proliferation</span><span class="op">$</span><span class="va">summary</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    Proliferation_score</span></span>
<span><span class="co">## V3          0.22333804</span></span>
<span><span class="co">## V4          0.48095696</span></span>
<span><span class="co">## V5         -0.21546692</span></span>
<span><span class="co">## V6          0.33213053</span></span>
<span><span class="co">## V7         -0.08829706</span></span>
<span><span class="co">## V8         -0.11826046</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="cell-state-trajectories">Cell state trajectories<a class="anchor" aria-label="anchor" href="#cell-state-trajectories"></a>
</h2>
<p>Diffusion maps identify differentiation trajectories. scMuffin relies
on the diffusion pseudo time calculation available in the R package
“destiny” <span class="citation">(Angerer et al. 2016)</span>. Here we
calculate the diffusion map over the first 50 PC (to speed up
computation), using a random cell to obtain diffusion pseudotimes:</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">scML</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/diff_map.html">diff_map</a></span><span class="op">(</span><span class="va">scML</span>, </span>
<span>                 root_cell <span class="op">=</span> <span class="st">"random"</span>,</span>
<span>                 n_pcs <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span></code></pre></div>
<p>A data.frame with the most important features of the analysis (the
first two eigenvectors, pseudotime, branch information and whether a
cell is a tip of the branch or not) are stored
<code>scML$diffusion_map_pseudo_t$summary</code>:</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">scML</span><span class="op">$</span><span class="va">diffusion_map_pseudo_t</span><span class="op">$</span><span class="va">summary</span></span></code></pre></div>
<pre><code><span><span class="co">##            DC1         DC2       dpt branch  tips</span></span>
<span><span class="co">## V3  0.02440015 0.027054071 1.3328347     NA FALSE</span></span>
<span><span class="co">## V4  0.03072120 0.038239911 1.4752607      2 FALSE</span></span>
<span><span class="co">## V5 -0.01926577 0.005752026 0.3735439      1 FALSE</span></span>
<span><span class="co">## V6  0.03191479 0.047083928 1.5085980      2 FALSE</span></span>
<span><span class="co">## V7 -0.01855966 0.004971247 0.3738625      1 FALSE</span></span>
<span><span class="co">## V8 -0.01856063 0.005047917 0.3926285      1 FALSE</span></span></code></pre>
<p>The full DPT object from destiny is stored in the element
<code>scML$diffusion_map_pseudo_t$full</code>. This allows the user to
take advantage of destiny <a href="https://github.com/theislab/destiny/" class="external-link">functions</a>, such as
<code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code>, e.g.</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">destiny</span><span class="fu">::</span><span class="fu">plot</span><span class="op">(</span><span class="va">scML</span><span class="op">$</span><span class="va">diffusion_map_pseudo_t</span><span class="op">$</span><span class="va">full</span>, col_by <span class="op">=</span> <span class="st">'branch'</span><span class="op">)</span></span></code></pre></div>
<p>The function <code><a href="../reference/plot_diff_map.html">plot_diff_map()</a></code> visualizes a diffusion map
where cells are colored by any other set of cell-level values. In the
following example we plot the diffusion map colored by CNV-based cell
clusters:</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_diff_map.html">plot_diff_map</a></span><span class="op">(</span>scMuffinList <span class="op">=</span> <span class="va">scML</span>, </span>
<span>              col_data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html" class="external-link">setNames</a></span><span class="op">(</span><span class="va">scML</span><span class="op">$</span><span class="va">partitions</span><span class="op">$</span><span class="va">CNV</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">scML</span><span class="op">$</span><span class="va">partitions</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="images/diff_map_CNV.png" width="600"></p>
</div>
<div class="section level2">
<h2 id="cluster-enrichment-assessment">Cluster enrichment assessment<a class="anchor" aria-label="anchor" href="#cluster-enrichment-assessment"></a>
</h2>
<p>Cell clusters can be assessed for enrichment in quantitative and
categorical values. The appropriate statistical test is automatically
chosen according to feature type. In this example, we assess cluster
enrichment for the feature <code>gene_set_scoring</code> (quantitative
one) for the cluster defined by the partition
<code>global_expr</code>:</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">scML</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/assess_cluster_enrichment.html">assess_cluster_enrichment</a></span><span class="op">(</span><span class="va">scML</span>, </span>
<span>                                  feature_name <span class="op">=</span> <span class="st">"gene_set_scoring"</span>, </span>
<span>                                  partition_id <span class="op">=</span> <span class="st">"global_expr"</span><span class="op">)</span></span></code></pre></div>
<p>In case of quantitative features the result is a list named CSEA,
placed under the elements <code>cluster_data$global_expr</code>
(partition id). The list contains the gene set table and the leading
edge results. Here’s the result related to the gene set
<code>Angiogenesis</code>:</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">scML</span><span class="op">$</span><span class="va">cluster_data</span><span class="op">$</span><span class="va">global_expr</span><span class="op">$</span><span class="va">CSEA</span><span class="op">$</span><span class="va">Angiogenesis</span></span></code></pre></div>
<pre><code><span><span class="co">##   id size         es        nes nperm      p_val  adj_p_val q_val       FDRq</span></span>
<span><span class="co">## 1  0  588 -0.1912822         NA     2         NA         NA    NA         NA</span></span>
<span><span class="co">## 2  1  538  0.1957418  0.8894305    95 0.80000000 0.93333333    NA 0.80000000</span></span>
<span><span class="co">## 3  2  500  0.2160336  0.9846048    94 0.56382979 0.78936170    NA 1.00000000</span></span>
<span><span class="co">## 4  3  331 -0.3133212         NA     7         NA         NA    NA         NA</span></span>
<span><span class="co">## 5  4  257  0.2206047  0.9748262    89 0.48314607 0.78936170    NA 0.78624535</span></span>
<span><span class="co">## 6  5  186  0.2309628  0.9659241    81 0.53086420 0.78936170    NA 0.66022305</span></span>
<span><span class="co">## 7  6  176  0.6179953  2.4796553    83 0.01204819 0.07954545    NA 0.01204819</span></span>
<span><span class="co">## 8  7  140  0.4205973  1.6200568    88 0.02272727 0.07954545    NA 0.02272727</span></span>
<span><span class="co">## 9  8  115 -0.1547180 -0.7373612    14 1.00000000 1.00000000    NA 1.00000000</span></span>
<span><span class="co">##   tags tags_perc list_top list_top_perc lead_edge</span></span>
<span><span class="co">## 1  123 0.2525667      505     0.2056189 0.2502578</span></span>
<span><span class="co">## 2   95 0.1779026      477     0.1942182 0.1831786</span></span>
<span><span class="co">## 3   62 0.1593830      334     0.1359935 0.1636240</span></span>
<span><span class="co">## 4   95 0.3356890      503     0.2048046 0.3017030</span></span>
<span><span class="co">## 5   85 0.3333333      768     0.3127036 0.2556414</span></span>
<span><span class="co">## 6   23 0.1729323      387     0.1575733 0.1540237</span></span>
<span><span class="co">## 7  107 0.6079545      633     0.2577362 0.4860970</span></span>
<span><span class="co">## 8   37 0.3700000      676     0.2752443 0.2795416</span></span>
<span><span class="co">## 9   31 0.3131313      662     0.2695440 0.2383358</span></span></code></pre>
<p>In this this example, we assess cluster enrichment in relation to the
categorical feature <code>CC_Phase</code>, namely the cell cycle phase
calculated by means of Seurat function <a href="https://satijalab.org/seurat/reference/cellcyclescoring" class="external-link"><code>CellCycleScoring()</code></a>
and added to <code>scML</code> by means of <code><a href="../reference/add_features.html">add_features()</a></code>
(see above):</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">scML</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/assess_cluster_enrichment.html">assess_cluster_enrichment</a></span><span class="op">(</span><span class="va">scML</span>, </span>
<span>                                  feature_name <span class="op">=</span> <span class="st">"CC_Phase"</span>, </span>
<span>                                  partition_id <span class="op">=</span> <span class="st">"global_expr"</span><span class="op">)</span></span></code></pre></div>
<p>As for categorical features the result is a list named ORA, placed
under the elements <code>cluster_data$global_expr</code> (partition id).
The list contains ORA results for every categorical value. Here’s the
enrichment of clusters in terms of cells with value “G1”:</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">scML</span><span class="op">$</span><span class="va">cluster_data</span><span class="op">$</span><span class="va">global_expr</span><span class="op">$</span><span class="va">ORA</span><span class="op">$</span><span class="va">CC_Phase</span><span class="op">$</span><span class="va">G1</span></span></code></pre></div>
<pre><code><span><span class="co">##   id    N   wb  bb  bd wbd       exp       er            p        p_adj</span></span>
<span><span class="co">## 0  0 2831 2056 775 588 547 427.03214 1.280934 4.898697e-43 2.204414e-42</span></span>
<span><span class="co">## 1  1 2831 2056 775 538 516 390.71989 1.320639 4.370181e-53 3.933163e-52</span></span>
<span><span class="co">## 2  2 2831 2056 775 500   0 363.12257 0.000000 1.000000e+00 1.000000e+00</span></span>
<span><span class="co">## 3  3 2831 2056 775 331 299 240.38714 1.243827 4.638303e-17 8.348946e-17</span></span>
<span><span class="co">## 4  4 2831 2056 775 257 255 186.64500 1.366230 1.095704e-34 3.287111e-34</span></span>
<span><span class="co">## 5  5 2831 2056 775 186 148 135.08160 1.095634 1.546645e-02 1.988543e-02</span></span>
<span><span class="co">## 6  6 2831 2056 775 176 174 127.81915 1.361298 1.102600e-22 2.480850e-22</span></span>
<span><span class="co">## 7  7 2831 2056 775 140 117 101.67432 1.150733 1.320545e-03 1.980817e-03</span></span>
<span><span class="co">## 8  8 2831 2056 775 115   0  83.51819 0.000000 1.000000e+00 1.000000e+00</span></span></code></pre>
<p>The enrichment analysis results appearing in these tables can be
easily extracted and organized in a clusters-by-values table by means of
<code>extract_cluster_enrichment_table</code>. For instance, here we
extract CSEA NES and FDRq values, and ORA er (enrichment ratio)
values:</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">csea_fdr_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_cluster_enrichment_table.html">extract_cluster_enrichment_table</a></span><span class="op">(</span><span class="va">scML</span>,  </span>
<span>                                                   partition_id <span class="op">=</span> <span class="st">"global_expr"</span>, </span>
<span>                                                   type <span class="op">=</span> <span class="st">"CSEA"</span>, </span>
<span>                                                   quantity <span class="op">=</span> <span class="st">"FDRq"</span><span class="op">)</span></span>
<span><span class="va">csea_nes_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_cluster_enrichment_table.html">extract_cluster_enrichment_table</a></span><span class="op">(</span><span class="va">scML</span>,  </span>
<span>                                                   partition_id <span class="op">=</span> <span class="st">"global_expr"</span>, </span>
<span>                                                   type <span class="op">=</span> <span class="st">"CSEA"</span>,</span>
<span>                                                   quantity <span class="op">=</span> <span class="st">"nes"</span><span class="op">)</span></span>
<span><span class="va">ora_p_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_cluster_enrichment_table.html">extract_cluster_enrichment_table</a></span><span class="op">(</span><span class="va">scML</span>, </span>
<span>                                                partition_id <span class="op">=</span> <span class="st">"global_expr"</span>, </span>
<span>                                                type <span class="op">=</span> <span class="st">"ORA"</span>, </span>
<span>                                                quantity <span class="op">=</span> <span class="st">"p"</span><span class="op">)</span></span>
<span><span class="va">csea_fdr_table</span></span></code></pre></div>
<pre><code><span><span class="co">##   Angiogenesis</span></span>
<span><span class="co">## 0           NA</span></span>
<span><span class="co">## 1   0.80000000</span></span>
<span><span class="co">## 2   1.00000000</span></span>
<span><span class="co">## 3           NA</span></span>
<span><span class="co">## 4   0.78624535</span></span>
<span><span class="co">## 5   0.66022305</span></span>
<span><span class="co">## 6   0.01204819</span></span>
<span><span class="co">## 7   0.02272727</span></span>
<span><span class="co">## 8   1.00000000</span></span></code></pre>
<p>These tables can be plotted with the function
<code>plot_heatmap_features_by_clusters</code>. In the following example
we plot NES values with asterisks according to their significance:</p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_heatmap_features_by_clusters.html">plot_heatmap_features_by_clusters</a></span><span class="op">(</span>feature_source <span class="op">=</span> <span class="va">csea_nes_table</span>, </span>
<span>                                  significance_matrix <span class="op">=</span> <span class="va">csea_fdr_table</span>, </span>
<span>                                  sig_threshold <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span></code></pre></div>
<p><img src="images/heatmap_features_NES_by_clusters.png" width="600"></p>
<p>Similarly, it’s possible to extract the most significant “tags” of
any clusters; for example, here we extract the top 3 tags by FDRq (CSEA)
and p_adj (ORA):</p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">scML</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_cluster_enrichment_tags.html">extract_cluster_enrichment_tags</a></span><span class="op">(</span><span class="va">scML</span>, </span>
<span>                                        partition_id <span class="op">=</span> <span class="st">"global_expr"</span>, </span>
<span>                                        n_max_per_cluster <span class="op">=</span> <span class="fl">3</span>, </span>
<span>                                        CSEA_selection_criterion <span class="op">=</span> <span class="st">"FDRq"</span>, </span>
<span>                                        only_pos_nes <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                                        CSEA_selection_threshold <span class="op">=</span> <span class="fl">0.05</span>, </span>
<span>                                        ORA_selection_criterion <span class="op">=</span> <span class="st">"p_adj"</span>, </span>
<span>                                        ORA_selection_threshold <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span></span></code></pre></div>
<p>The results are placed under the <code>cluster_tags</code>
element:</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">scML</span><span class="op">$</span><span class="va">cluster_data</span><span class="op">$</span><span class="va">global_expr</span><span class="op">$</span><span class="va">cluster_tags</span><span class="op">$</span><span class="va">CSEA</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $`0`</span></span>
<span><span class="co">## [1] "Cell_Cycle"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $`1`</span></span>
<span><span class="co">## [1] "Hypoxia"      "Inflammation" "Metastasis"  </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $`2`</span></span>
<span><span class="co">## [1] "DNA_repair"    "Invasion"      "Proliferation"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $`3`</span></span>
<span><span class="co">## [1] "Hypoxia"       "Proliferation" "Quiescence"   </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $`4`</span></span>
<span><span class="co">## [1] "Hypoxia"    "Metastasis" "Cell_Cycle"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $`5`</span></span>
<span><span class="co">## [1] "DNA_damage" "Stemness"   "DNA_repair"</span></span></code></pre>
<p>The results of cluster enrichment can be visualized by barplots and
boxplots for, respectively, categorical values and quantitative
values.</p>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/barplot_cluster.html">barplot_cluster</a></span><span class="op">(</span><span class="va">scML</span>, </span>
<span>                partition_id <span class="op">=</span> <span class="st">"global_expr"</span>, </span>
<span>                feature_name <span class="op">=</span> <span class="st">"CC_Phase"</span>, </span>
<span>                feature_id <span class="op">=</span> <span class="st">"CC_Phase"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/boxplot_cluster.html">boxplot_cluster</a></span><span class="op">(</span><span class="va">scML</span>, </span>
<span>                feature_name <span class="op">=</span> <span class="st">"gene_set_scoring"</span>, </span>
<span>                partition_id <span class="op">=</span> <span class="st">"global_expr"</span><span class="op">)</span></span></code></pre></div>
<p><img src="images/barplot_cluster_2.png" width="600" alt="caption"><img src="images/boxplot_cluster_2.png" width="600" alt="caption"></p>
</div>
<div class="section level2">
<h2 id="comparison-between-clusters">Comparison between clusters<a class="anchor" aria-label="anchor" href="#comparison-between-clusters"></a>
</h2>
<div class="section level3">
<h3 id="intra-dataset">Intra-dataset<a class="anchor" aria-label="anchor" href="#intra-dataset"></a>
</h3>
<p>The function <code>overlap_matrix</code> calculates the overlap
coefficient between all-pairs of clusters of two or more partitions of
the same cells (same dataset):</p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">scML</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/overlap_matrix.html">overlap_matrix</a></span><span class="op">(</span><span class="va">scML</span><span class="op">)</span></span></code></pre></div>
<p>The results are stored under the element `cluster_comparison```:</p>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">scML</span><span class="op">$</span><span class="va">cluster_comparison</span><span class="op">$</span><span class="va">overlap_matrix</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                   CNV_0       CNV_1     CNV_2      CNV_3 global_expr_0</span></span>
<span><span class="co">## CNV_0         1.0000000 0.000000000 0.0000000 0.00000000   0.389455782</span></span>
<span><span class="co">## CNV_1         0.0000000 1.000000000 0.0000000 0.00000000   0.005102041</span></span>
<span><span class="co">## CNV_2         0.0000000 0.000000000 1.0000000 0.00000000   0.559523810</span></span>
<span><span class="co">## CNV_3         0.0000000 0.000000000 0.0000000 1.00000000   0.082568807</span></span>
<span><span class="co">## global_expr_0 0.3894558 0.005102041 0.5595238 0.08256881   1.000000000</span></span>
<span><span class="co">## global_expr_1 0.6115242 0.000000000 0.3401487 0.07951070   0.000000000</span></span>
<span><span class="co">##               global_expr_1 global_expr_2 global_expr_3 global_expr_4</span></span>
<span><span class="co">## CNV_0             0.6115242    0.00400000    0.12688822   0.665369650</span></span>
<span><span class="co">## CNV_1             0.0000000    0.97800000    0.05740181   0.000000000</span></span>
<span><span class="co">## CNV_2             0.3401487    0.00600000    0.17824773   0.326848249</span></span>
<span><span class="co">## CNV_3             0.0795107    0.01834862    0.64525994   0.007782101</span></span>
<span><span class="co">## global_expr_0     0.0000000    0.00000000    0.00000000   0.000000000</span></span>
<span><span class="co">## global_expr_1     1.0000000    0.00000000    0.00000000   0.000000000</span></span>
<span><span class="co">##               global_expr_5 global_expr_6 global_expr_7 global_expr_8</span></span>
<span><span class="co">## CNV_0            0.00000000     0.7386364   0.007142857   0.000000000</span></span>
<span><span class="co">## CNV_1            0.79569892     0.0000000   0.850000000   0.973913043</span></span>
<span><span class="co">## CNV_2            0.02150538     0.2613636   0.007142857   0.008695652</span></span>
<span><span class="co">## CNV_3            0.18279570     0.0000000   0.135714286   0.017391304</span></span>
<span><span class="co">## global_expr_0    0.00000000     0.0000000   0.000000000   0.000000000</span></span>
<span><span class="co">## global_expr_1    0.00000000     0.0000000   0.000000000   0.000000000</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="inter-dataset">Inter-dataset<a class="anchor" aria-label="anchor" href="#inter-dataset"></a>
</h3>
<p>Inter-dataset comparison is performed through the function
<code>inter_dataset_comparison</code>, which require a list of Seurat
objects and a gene set list. The activity of this gene set list will be
assessed over the clusters of all datasets. In needed, the function
<code>prepare_cluster_markers_list</code> provides the possibility to
prepare a gene set list of cluster markers, starting</p>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dataset_cmp_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/inter_dataset_comparison.html">inter_dataset_comparison</a></span><span class="op">(</span>seu_obj_list <span class="op">=</span> <span class="va">seu_obj_list</span>, </span>
<span>                                            gsl <span class="op">=</span> <span class="va">cluster_markers_list</span>, </span>
<span>                                            genes_max <span class="op">=</span> <span class="fl">500</span>, genes_min <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_heatmap_dataset_comparison.html">plot_heatmap_dataset_comparison</a></span><span class="op">(</span><span class="va">dataset_cmp_res</span>, </span>
<span>                                outfile <span class="op">=</span> <span class="st">"heatmap_ds_cmp.png"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_heatmap_dataset_comparison.html">plot_heatmap_dataset_comparison</a></span><span class="op">(</span><span class="va">dataset_cmp_res</span>, </span>
<span>                                outfile <span class="op">=</span> <span class="st">"heatmap_ds_cmp_p.png"</span>, </span>
<span>                                type <span class="op">=</span> <span class="st">"significance"</span><span class="op">)</span></span></code></pre></div>
<p><img src="images/heatmap_ds_cmp.png" width="600" alt="caption"><img src="images/heatmap_ds_cmp_p.png" width="600" alt="caption"></p>
<p>The function can be used to analyze any gene set. In the following
example we assess the expression of CancerSEA gene sets across
datasets:</p>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gsl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prepare_gsls.html">prepare_gsls</a></span><span class="op">(</span>gs_sources <span class="op">=</span> <span class="st">"CancerSEA"</span>, </span>
<span>                    genes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">seu_obj_list</span>, <span class="va">rownames</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">dataset_cmp_res_cancersea</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/inter_dataset_comparison.html">inter_dataset_comparison</a></span><span class="op">(</span>seu_obj_list <span class="op">=</span> <span class="va">seu_obj_list</span>, </span>
<span>                                                      gsl <span class="op">=</span> <span class="va">gsl</span><span class="op">$</span><span class="va">CancerSEA</span>, </span>
<span>                                                      genes_max <span class="op">=</span> <span class="fl">500</span>, </span>
<span>                                                      genes_min <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_heatmap_dataset_comparison.html">plot_heatmap_dataset_comparison</a></span><span class="op">(</span><span class="va">dataset_cmp_res_cancersea</span>, </span>
<span>                                outfile <span class="op">=</span> <span class="st">"heatmap_ds_cmp_cancer.png"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="images/heatmap_ds_cmp_cancer.png" width="600" alt=""><p class="caption">caption</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<!-- ## Comparison of partitions and definition of meta-clusters

Lastly, scMuffin provides some functions to compare 


```r
cl_list <- partitions_to_list(partitions = clust_obj)
ov_mat <- overlap_matrix(cl_list)
meta_cl <- meta_cluster(ov_mat, n_step = 10, max_clust = 15)
meta_cl_cell <- get_meta_clusters(cl_list, meta_cl)
plot_meta_clusters(ov_mat, meta_clusters = meta_cl)
```
-->
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Angerer2016" class="csl-entry">
Angerer, Philipp, Laleh Haghverdi, Maren Büttner, Fabian J. Theis,
Carsten Marr, and Florian Buettner. 2016. <span>“<span class="nocase">destiny : diffusion maps for large-scale single-cell data
in R</span>.”</span> <em>Bioinformatics</em> 32 (8): 1241–43. <a href="https://doi.org/10.1093/bioinformatics/btv715" class="external-link">https://doi.org/10.1093/bioinformatics/btv715</a>.
</div>
<div id="ref-Franzen2019" class="csl-entry">
Franzén, Oscar, Li-Ming Gan, and Johan L M Björkegren. 2019.
<span>“<span class="nocase">PanglaoDB: a web server for exploration of
mouse and human single-cell RNA sequencing data</span>.”</span>
<em>Database</em> 2019 (January). <a href="https://doi.org/10.1093/database/baz046" class="external-link">https://doi.org/10.1093/database/baz046</a>.
</div>
<div id="ref-Hao2021" class="csl-entry">
Hao, Yuhan, Stephanie Hao, Erica Andersen-Nissen, William M. Mauck,
Shiwei Zheng, Andrew Butler, Maddie J. Lee, et al. 2021. <span>“<span class="nocase">Integrated analysis of multimodal single-cell
data</span>.”</span> <em>Cell</em> 184 (13): 3573–3587.e29. <a href="https://doi.org/10.1016/j.cell.2021.04.048" class="external-link">https://doi.org/10.1016/j.cell.2021.04.048</a>.
</div>
<div id="ref-Subramanian2005" class="csl-entry">
Subramanian, Aravind, Pablo Tamayo, Vamsi K. Mootha, Sayan Mukherjee,
Benjamin L. Ebert, Michael A. Gillette, Amanda Paulovich, et al. 2005.
<span>“<span class="nocase">Gene set enrichment analysis: A
knowledge-based approach for interpreting genome-wide expression
profiles</span>.”</span> <em>Proceedings of the National Academy of
Sciences</em> 102 (43): 15545–50. <a href="https://doi.org/10.1073/pnas.0506580102" class="external-link">https://doi.org/10.1073/pnas.0506580102</a>.
</div>
<div id="ref-Yuan2019" class="csl-entry">
Yuan, Huating, Min Yan, Guanxiong Zhang, Wei Liu, Chunyu Deng, Gaoming
Liao, Liwen Xu, et al. 2019. <span>“<span class="nocase">CancerSEA: a
cancer single-cell state atlas</span>.”</span> <em>Nucleic Acids
Research</em> 47 (D1): D900–908. <a href="https://doi.org/10.1093/nar/gky939" class="external-link">https://doi.org/10.1093/nar/gky939</a>.
</div>
<div id="ref-Yuan2018" class="csl-entry">
Yuan, Jinzhou, Hanna Mendes Levitin, Veronique Frattini, Erin C. Bush,
Deborah M. Boyett, Jorge Samanamud, Michele Ceccarelli, et al. 2018.
<span>“<span class="nocase">Single-cell transcriptome analysis of
lineage diversity in high-grade glioma</span>.”</span> <em>Genome
Medicine</em> 10 (1): 57. <a href="https://doi.org/10.1186/s13073-018-0567-9" class="external-link">https://doi.org/10.1186/s13073-018-0567-9</a>.
</div>
<div id="ref-Zhang2019" class="csl-entry">
Zhang, Xinxin, Yujia Lan, Jinyuan Xu, Fei Quan, Erjie Zhao, Chunyu Deng,
Tao Luo, et al. 2019. <span>“<span class="nocase">CellMarker: a manually
curated resource of cell markers in human and mouse</span>.”</span>
<em>Nucleic Acids Research</em> 47 (D1): D721–28. <a href="https://doi.org/10.1093/nar/gky900" class="external-link">https://doi.org/10.1093/nar/gky900</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Valentina Nale, Noemi Di Nanni, Alice Chiodi, Ettore Mosca.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
